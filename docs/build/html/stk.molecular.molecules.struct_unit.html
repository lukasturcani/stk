

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>stk.molecular.molecules.struct_unit module &mdash; stk  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> stk
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">stk.molecular.molecules.struct_unit module</a></li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">stk</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>stk.molecular.molecules.struct_unit module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/stk.molecular.molecules.struct_unit.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-stk.molecular.molecules.struct_unit">
<span id="stk-molecular-molecules-struct-unit-module"></span><h1>stk.molecular.molecules.struct_unit module<a class="headerlink" href="#module-stk.molecular.molecules.struct_unit" title="Permalink to this headline">¶</a></h1>
<p>Defines <a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> classes.</p>
<p><a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> represents the monomers that make up
macromolecules. These are commonly refered to as <code class="docutils literal notranslate"><span class="pre">building</span> <span class="pre">blocks</span></code> in
the documentation. <a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> holds information concerning
only a single building block molecule. For example, the number of atoms
and bonds a building block may have. It also has information about the
functional groups present in the building block molecule (see
<a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FGInfo" title="stk.molecular.functional_groups.FGInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">FGInfo</span></code></a>). The class also allows manipulation of the lone
building block molecule, such as rotations and translations.</p>
<p>The <a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> should be inherited as necessary. For example,
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit2" title="stk.molecular.molecules.struct_unit.StructUnit2"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit2</span></code></a> adds manipulations relavant to molecules with 2
functional groups. <a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit3" title="stk.molecular.molecules.struct_unit.StructUnit3"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit3</span></code></a> adds manipulations relavant to
molecules with 3 or more functional groups. If you have a monomer which
needs specific information or manipulations, give it its own class.</p>
<p><a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> contains <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a> instances
representing functional groups used during macromolecular assembly.
There are divided into bonders and deleters (see the documentation of
<a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FGInfo" title="stk.molecular.functional_groups.FGInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">FGInfo</span></code></a> and <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a>), which determines
which atoms form bonds and which are removed during assembly.</p>
<dl class="class">
<dt id="stk.molecular.molecules.struct_unit.CachedStructUnit">
<em class="property">class </em><code class="descclassname">stk.molecular.molecules.struct_unit.</code><code class="descname">CachedStructUnit</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.CachedStructUnit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code></p>
<p>A metaclass for making <a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> create cached instances.</p>
<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.CachedStructUnit.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.CachedStructUnit.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.CachedStructUnit.mro">
<code class="descname">mro</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.CachedStructUnit.mro" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a type’s method resolution order.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="stk.molecular.molecules.struct_unit.StructUnit">
<em class="property">class </em><code class="descclassname">stk.molecular.molecules.struct_unit.</code><code class="descname">StructUnit</code><span class="sig-paren">(</span><em>mol</em>, <em>functional_groups=None</em>, <em>name=''</em>, <em>note=''</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">stk.molecular.molecules.molecule.Molecule</span></code></a></p>
<p>Represents the building blocks of macromolecules.</p>
<p>The goal of this class is to conveniently store information about,
and perform operations on, single instances of macromolecular
building blocks.</p>
<dl class="attribute">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.init_funcs">
<code class="descname">init_funcs</code><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.init_funcs" title="Permalink to this definition">¶</a></dt>
<dd><p>This dictionary holds the various functions which can be used
to initialize <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecules and pairs them with the
appropriate file extension.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.file">
<code class="descname">file</code><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.file" title="Permalink to this definition">¶</a></dt>
<dd><p>The full path to the molecular structure file holding the
molecule. The supported file formats are the keys in
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit.init_funcs" title="stk.molecular.molecules.struct_unit.StructUnit.init_funcs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">init_funcs</span></code></a>. As long as a file with one of these
extensions is provided, the correct initialization function
will be used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.func_groups">
<code class="descname">func_groups</code><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.func_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>The functional groups present in the molecule. The id of
each <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a> should match its index.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.func_group_infos">
<code class="descname">func_group_infos</code><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.func_group_infos" title="Permalink to this definition">¶</a></dt>
<dd><p>The functional group types present in the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FGInfo" title="stk.molecular.functional_groups.FGInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">FGInfo</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>mol</em>, <em>functional_groups=None</em>, <em>name=''</em>, <em>note=''</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a <a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code>) – <p>Can be one of 3 things:</p>
<blockquote>
<div><ol class="arabic">
<li>A path to a molecular structure file.</li>
<li>A <code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code> object.</li>
<li>V3000 MDL Mol block.</li>
</ol>
</div></blockquote>
</li>
<li><strong>functional_groups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of the functional groups which are to have atoms
tagged. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a functional group name found in the
path <cite>file</cite>  is used. If no functional groups are provided
to this parameter and the name of one is not present in
<cite>file</cite>, no tagging is done.</li>
<li><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – A name which can be optionally given to the molecule for
easy identification.</li>
<li><strong>note</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – A note or comment about the molecule.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit._json_init">
<em class="property">classmethod </em><code class="descname">_json_init</code><span class="sig-paren">(</span><em>json_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit._json_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Completes a JSON initialization.</p>
<p>This function is not to be used. Use <code class="xref py py-meth docutils literal notranslate"><span class="pre">Molecule.load()</span></code>
for loading instances from a JSON string. That function will
automatically call this one.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>json_dict</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – A dictionary holding the attribute data of the molecule.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit._set_orientation2">
<code class="descname">_set_orientation2</code><span class="sig-paren">(</span><em>start</em>, <em>end</em>, <em>conformer</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit._set_orientation2" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule by a rotation from <cite>start</cite> to <cite>end</cite>.</p>
<p>Given two direction vectors, <cite>start</cite> and <cite>end</cite>, this method
applies the rotation required transform <cite>start</cite> to <cite>end</cite> on
the molecule. The rotation occurs about the centroid of the
molecule.</p>
<p>For example, if the <cite>start</cite> and <cite>end</cite> vectors
are 45 degrees apart, a 45 degree rotation will be applied to
the molecule. The rotation will be along the appropriate
direction.</p>
<p>The great thing about this method is that you as long as you
can associate a gemotric feature of the molecule with a vector,
then the molecule can be roatated so that this vector is
aligned with <cite>end</cite>. The defined vector can be virtually
anything. This means that any geometric feature of the molecule
can be easily aligned with any arbitrary axis.</p>
<p class="rubric">Notes</p>
<p>The difference between this method and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">set_orientation()</span></code> is about which point the
rotation occurs: centroid of bonder atoms versus centroid of
entire molecule, respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A vector which is to be rotated so that it transforms to
the <cite>end</cite> vector.</li>
<li><strong>end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – This array holds the vector, onto which <cite>start</cite> is rotated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit._write_mdl_mol_file">
<code class="descname">_write_mdl_mol_file</code><span class="sig-paren">(</span><em>path</em>, <em>atoms</em>, <em>conformer</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit._write_mdl_mol_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a V3000 <code class="docutils literal notranslate"><span class="pre">.mol</span></code> file of the molecule</p>
<p>This function should not be used directly, only via
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit.write" title="stk.molecular.molecules.struct_unit.StructUnit.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file being written.</li>
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit._write_pdb_file">
<code class="descname">_write_pdb_file</code><span class="sig-paren">(</span><em>path</em>, <em>atoms</em>, <em>conformer</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit._write_pdb_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <code class="docutils literal notranslate"><span class="pre">.pdb</span></code> file of the molecule</p>
<p>This function should not be used directly, only via
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit.write" title="stk.molecular.molecules.struct_unit.StructUnit.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file being written.</li>
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit._write_xyz_file">
<code class="descname">_write_xyz_file</code><span class="sig-paren">(</span><em>path</em>, <em>atoms</em>, <em>conformer</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit._write_xyz_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <code class="docutils literal notranslate"><span class="pre">.xyz</span></code> file of the molecule</p>
<p>This function should not be used directly, only via
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit.write" title="stk.molecular.molecules.struct_unit.StructUnit.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file being written.</li>
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.all_atom_coords">
<code class="descname">all_atom_coords</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.all_atom_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields the coordinates of atoms in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> – The yielded <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> has the form</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
</pre></div>
</div>
<p class="last">Where the first element is the atom id and the second
element is an array holding the coordinates of the atom.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.all_bonder_distances">
<code class="descname">all_bonder_distances</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.all_bonder_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield distances between all pairs of bonder centroids.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of the form <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">54,</span> <span class="pre">12.54)</span></code>.
The first two elements are the ids of the involved
functional groups and the third element is the distance
between them.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.atom_centroid">
<code class="descname">atom_centroid</code><span class="sig-paren">(</span><em>atom_ids</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.atom_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the centroid of a group of atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of atoms which which are used to calculate the
centroid.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The centroid of atoms specified by <cite>atom_ids</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.atom_coords">
<code class="descname">atom_coords</code><span class="sig-paren">(</span><em>atom_id</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.atom_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Return coordinates of an atom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the atom whose coordinates are desired.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An array holding the x, y and z coordinates of the atom.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.atom_distance">
<code class="descname">atom_distance</code><span class="sig-paren">(</span><em>atom1_id</em>, <em>atom2_id</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.atom_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the distance between 2 atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom1_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the first atom.</li>
<li><strong>atom2_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the second atom.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The distance between the first and second atoms.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.double</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.atom_symbol">
<code class="descname">atom_symbol</code><span class="sig-paren">(</span><em>atom_id</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.atom_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the symbol of the atom with id <cite>atom_id</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id number of the atom.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The atomic symbol of the atom.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.bonder_centroid">
<code class="descname">bonder_centroid</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.bonder_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the centroid of the bonder atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An array holding the midpoint of the bonder atoms.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.bonder_centroids">
<code class="descname">bonder_centroids</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.bonder_centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the centriod of bonder atoms in each fg.</p>
<p>The centroids are yielded in order, with the centroid of
the functional group with an id of <code class="docutils literal notranslate"><span class="pre">0</span></code> first.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> – The bonder centroid of a functional group.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.bonder_direction_vectors">
<code class="descname">bonder_direction_vectors</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.bonder_direction_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields the direction vectors between bonder atoms.</p>
<p>First the centroids of bonder atoms within the same functional
group are found. Then direction vectors between all pairs of
these centroids are yielded. Each pair is only yielded once.</p>
<p>The yielded vector is normalized.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> – They yielded tuple has the form</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.2</span><span class="p">,</span> <span class="mf">43.3</span><span class="p">,</span> <span class="mf">9.78</span><span class="p">]))</span>
</pre></div>
</div>
<p class="last">The first two elements of the tuple represent the ids
of the start and end fgs of the vector, respectively. The
array is the direction vector running between the
functional group positions.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.bonder_position_matrix">
<code class="descname">bonder_position_matrix</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.bonder_position_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a matrix holding the positions of bonder centroids.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The array has the shape <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">n]</span></code>. Each column holds the
x, y and z coordinates of a bonder centroid. The index of
the column corresponds to the id of the functional group.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.cache">
<code class="descname">cache</code><em class="property"> = {}</em><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.center_of_mass">
<code class="descname">center_of_mass</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.center_of_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the centre of mass of the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An array holding the coordinates of the center of mass.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Center_of_mass">https://en.wikipedia.org/wiki/Center_of_mass</a></p>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.centroid">
<code class="descname">centroid</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the centroid of the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A numpy array holding the position of the centroid.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.centroid_centroid_dir_vector">
<code class="descname">centroid_centroid_dir_vector</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.centroid_centroid_dir_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the direction vector between the 2 molecular centroids.</p>
<p>The first molecular centroid is the centroid of the entire
molecule. The second molecular centroid is given by
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit.bonder_centroid" title="stk.molecular.molecules.struct_unit.StructUnit.bonder_centroid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bonder_centroid()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The normalized direction vector running from the centroid
of the bonder atoms to the molecular centroid.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.core">
<code class="descname">core</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.core" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the molecule with no H or functional group atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The “core” of the molecule.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.dihedral_strain">
<code class="descname">dihedral_strain</code><span class="sig-paren">(</span><em>dihedral_SMARTS=''</em>, <em>target=180</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.dihedral_strain" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the difference between the average dihedral and target.</p>
<p>The differences is a returned as a percent.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dihedral_SMARTS</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The SMARTS code for the dihedral of interest.</li>
<li><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Float representing the target value for the dihedral angle.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The percent difference between the average dihedral in the
molecule and the target value.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.direction">
<code class="descname">direction</code><span class="sig-paren">(</span><em>exclude_ids=None</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.direction" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the direction of the molecule or its atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>excluded_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of atoms exluded from the direction calculation.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Direction vector of the molecule (excluding <cite>exclude_ids</cite>).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.dump">
<code class="descname">dump</code><span class="sig-paren">(</span><em>path</em>, <em>include_attrs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a JSON <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> of the molecule to a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file to which the JSON dict should be
written.</li>
<li><strong>include_attrs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of attributes of the molecule to be added to
the JSON. Each attribute is saved as a string using
<code class="xref py py-func docutils literal notranslate"><span class="pre">repr()</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.fg_bonder_centroid">
<code class="descname">fg_bonder_centroid</code><span class="sig-paren">(</span><em>fg_id</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.fg_bonder_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>The centroid of bonder atoms in a functional group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fg_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the functional group.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The coordinates of a bonder centroid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.fg_distance">
<code class="descname">fg_distance</code><span class="sig-paren">(</span><em>fg1</em>, <em>fg2</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.fg_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>The distance between the bonder centroids of two fgs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fg1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The <code class="docutils literal notranslate"><span class="pre">fg_id</span></code> of the first fg.</li>
<li><strong>fg2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The <code class="docutils literal notranslate"><span class="pre">fg_id</span></code> of the second fg.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The distance between <cite>fg1</cite> and <cite>fg2</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.from_dict">
<em class="property">classmethod </em><code class="descname">from_dict</code><span class="sig-paren">(</span><em>json_dict</em>, <em>load_names=True</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> from a JSON <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> returned has the class specified in
<cite>json_dict</cite>, not <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>json_dict</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – A <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> holding the JSON representation of a
molecule.</li>
<li><strong>load_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> then the <code class="docutils literal notranslate"><span class="pre">name</span></code> key stored in <cite>json_dict</cite>
is loaded.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The molecule represented by <cite>json_dict</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.functional_groups">
<code class="descname">functional_groups</code><span class="sig-paren">(</span><em>fg_names</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.functional_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds given functional groups in the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fg_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The names of functional groups which are to be found
within the molecule.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> holding a <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup`</span></code>
instance for every matched functional group in the
molecule.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.gen_key">
<em class="property">static </em><code class="descname">gen_key</code><span class="sig-paren">(</span><em>rdkit_mol</em>, <em>functional_groups</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.gen_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the key used when caching the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rdkit_mol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code>) – An <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> instance of the molecule.</li>
<li><strong>functional_groups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The name of the functional groups being used to make
macromolecules.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>The key used for caching the molecule. Has the form</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s1">&#39;amine&#39;</span><span class="p">,</span> <span class="s1">&#39;bromine&#39;</span><span class="p">,</span> <span class="s1">&#39;InChIString&#39;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.graph">
<code class="descname">graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a mathematical graph representing the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A graph where the nodes are the ids of the atoms and the
edges are the bonds.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">networkx.Graph</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.inchi">
<code class="descname">inchi</code><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.inchi" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the InChI of the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The InChI of the molecule.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">init_funcs</code><em class="property"> = {'.mae': &lt;function mol_from_mae_file&gt;, '.mol': functools.partial(&lt;Boost.Python.function object&gt;, sanitize=False, removeHs=False), '.mol2': functools.partial(&lt;Boost.Python.function object&gt;, sanitize=False, removeHs=False), '.pdb': functools.partial(&lt;Boost.Python.function object&gt;, sanitize=False, removeHs=False), '.sdf': functools.partial(&lt;Boost.Python.function object&gt;, sanitize=False, removeHs=False)}</em></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.init_random">
<em class="property">classmethod </em><code class="descname">init_random</code><span class="sig-paren">(</span><em>db</em>, <em>functional_groups=None</em>, <em>name=''</em>, <em>note=''</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.init_random" title="Permalink to this definition">¶</a></dt>
<dd><p>Picks a random file from <cite>db</cite> to initialize from.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>db</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – A path to a database of molecular files.</li>
<li><strong>functional_groups</strong> (:class`list` of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The name of a functional groups which the molecules in <cite>db</cite>
have. By default it is assumed the name is present in the
path of the files.</li>
<li><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The name to be given to the created molecule.</li>
<li><strong>note</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – A note to be given to the created molecule.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A random molecule from <cite>db</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code> – If no files in <cite>db</cite> could be initialized from.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.is_core_atom">
<code class="descname">is_core_atom</code><span class="sig-paren">(</span><em>atom_id</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.is_core_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if atom is not H or part of a fg.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the atom being queried.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Indicates whether the atom with <cite>atom_id</cite> is part of the
core.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.json">
<code class="descname">json</code><span class="sig-paren">(</span><em>include_attrs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.json" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a JSON representation of the molecule.</p>
<p>The representation has the following form:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;class&#39;</span> <span class="p">:</span> <span class="s1">&#39;StructUnit&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mol_block&#39;</span> <span class="p">:</span> <span class="s1">&#39;&#39;&#39;A string holding the V3000 mol</span>
<span class="s1">                     block of the molecule.&#39;&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;note&#39;</span> <span class="p">:</span> <span class="s1">&#39;This molecule is nice.&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;benzene&#39;</span><span class="p">,</span>
    <span class="s1">&#39;atom_props&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;prop1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                       <span class="s1">&#39;prop2&#39;</span><span class="p">:</span> <span class="s1">&#39;value1&#39;</span><span class="p">}}</span>
<span class="p">}</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>include_attrs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of attributes of the molecule to be added to
the JSON. Each attribute is saved as a string using
<code class="xref py py-func docutils literal notranslate"><span class="pre">repr()</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> which represents the molecule.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.load">
<em class="property">classmethod </em><code class="descname">load</code><span class="sig-paren">(</span><em>path</em>, <em>load_names=True</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> from a JSON file.</p>
<p>The returned <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> has the class specified in the
JSON file, not <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path holding a JSON representation to a molecule.</li>
<li><strong>load_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> then the <code class="docutils literal notranslate"><span class="pre">name</span></code> key stored in the JSON file
is loaded.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The molecule held in <cite>path</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.max_diameter">
<code class="descname">max_diameter</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.max_diameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the largest distance between 2 atoms in the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of the form<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">max_diameter</span> <span class="o">=</span> <span class="p">(</span><span class="mf">312.3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">54</span><span class="p">)</span>
</pre></div>
</div>
<p>Where the first element is the largest inter-atomic
distance in the molecule. The next 2 elements are the ids
of the involved atoms.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of form (float, int, int)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.mdl_mol_block">
<code class="descname">mdl_mol_block</code><span class="sig-paren">(</span><em>atoms=None</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.mdl_mol_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a V3000 mol block of the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The V3000 mol block representing the molecule.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.minimize_theta">
<code class="descname">minimize_theta</code><span class="sig-paren">(</span><em>v1</em>, <em>v2</em>, <em>axis</em>, <em>centroid</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.minimize_theta" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule to minimize angle between <cite>v1</cite> and <cite>v2</cite>.</p>
<p>The rotation is done about the vector <cite>axis</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>v1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector which is rotated.</li>
<li><strong>v2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector which is stationary.</li>
<li><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector about which the rotation happens.</li>
<li><strong>centroid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The position vector at the center of the rotation.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.plane_normal">
<code class="descname">plane_normal</code><span class="sig-paren">(</span><em>atom_ids=None</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.plane_normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the best fit plane of the molecule or its atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The ids of the atoms that are assumed to be on the plane.
Only their coordinates will be used for fitting.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> then atoms forming the largest cycle are found
prior to fitting the plane.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Vector orthonormal to the plane of the molecule.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.position_matrix">
<code class="descname">position_matrix</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.position_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a matrix holding the atomic positions of a conformer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The array has the shape <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">n]</span></code>. Each column holds the
x, y and z coordinates of a bonder centroid. The index of
the column corresponds to the atom id.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>theta</em>, <em>axis</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule by <cite>theta</cite> about <cite>axis</cite>.</p>
<p>The rotation occurs about the molecular centroid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>theta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The size of the rotation in radians.</li>
<li><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The axis about which the rotation happens.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.rotate2">
<code class="descname">rotate2</code><span class="sig-paren">(</span><em>theta</em>, <em>axis</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.rotate2" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule by <cite>theta</cite> about <cite>axis</cite>.</p>
<p>The rotation occurs about the centroid of the bonder atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>theta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The size of the rotation in radians.</li>
<li><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The axis about which rotation happens.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.same">
<code class="descname">same</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.same" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <cite>other</cite> has the same molecular structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>) – The <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> instance you are checking has
the same structure.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the structures match.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.save_rdkit_atom_props">
<code class="descname">save_rdkit_atom_props</code><span class="sig-paren">(</span><em>prop_names</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.save_rdkit_atom_props" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates <a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule.atom_props" title="stk.molecular.molecules.molecule.Molecule.atom_props"><code class="xref py py-attr docutils literal notranslate"><span class="pre">atom_props</span></code></a> with rdkit atom tags.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>prop_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The names of atom properties which should be saved.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.set_bonder_centroid">
<code class="descname">set_bonder_centroid</code><span class="sig-paren">(</span><em>position</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.set_bonder_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Move the molecule so that the bonder centroid is on <cite>position</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>position</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – An array holding the desired the position. It holds
the x, y and z coordinates, respectively.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule after it has been shifted. The same
instance as in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.set_orientation">
<code class="descname">set_orientation</code><span class="sig-paren">(</span><em>start</em>, <em>end</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.set_orientation" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule by a rotation from <cite>start</cite> to <cite>end</cite>.</p>
<p>Given two direction vectors, <cite>start</cite> and <cite>end</cite>, this method
applies the rotation required transform <cite>start</cite> to <cite>end</cite> on
the molecule. The rotation occurs about the centroid of the
molecule.</p>
<p>For example, if the <cite>start</cite> and <cite>end</cite> vectors
are 45 degrees apart, a 45 degree rotation will be applied to
the molecule. The rotation will be along the appropriate
direction.</p>
<p>The great thing about this method is that you as long as you
can associate a geometric feature of the molecule with a
vector, then the molecule can be rotated so that this vector is
aligned with <cite>end</cite>. The defined vector can be virtually
anything. This means that any geometric feature of the molecule
can be easily aligned with any arbitrary axis.</p>
<p class="rubric">Notes</p>
<p>The difference between this method and
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit._set_orientation2" title="stk.molecular.molecules.struct_unit.StructUnit._set_orientation2"><code class="xref py py-meth docutils literal notranslate"><span class="pre">StructUnit._set_orientation2()</span></code></a> is about which point the
rotation occurs: centroid of the entire molecule versus
centroid of the bonder atoms, respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A vector which is to be rotated so that it transforms to
the <cite>end</cite> vector.</li>
<li><strong>end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – This array holds the vector, onto which <cite>start</cite> is rotated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.set_orientation2">
<code class="descname">set_orientation2</code><span class="sig-paren">(</span><em>end</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.set_orientation2" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate the molecule so that bonder atoms lie on <cite>end</cite>.</p>
<p>The molecule is rotated about the centroid of the bonder atoms.
It is rotated so that the direction vector running between the
2 bonder centroids is aligned with the vector <cite>end</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector with which the molecule’s bonder atoms should be
aligned.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.set_position">
<code class="descname">set_position</code><span class="sig-paren">(</span><em>position</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.set_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the centroid of the molecule to <cite>position</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>position</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – This array holds the position on which the centroid of the
molecule should be placed.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule with the centroid placed at
<cite>position</cite>. This is the same instance as that in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Molecule.mol</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.set_position_from_matrix">
<code class="descname">set_position_from_matrix</code><span class="sig-paren">(</span><em>pos_mat</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.set_position_from_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Set atomic positions of the molecule to those in <cite>pos_mat</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pos_mat</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – <p>The matrix holds the coordinates on which the atoms of the
molecule should be placed.</p>
<p>The shape of the matrix is <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">n]</span></code>. Each column of
<cite>pos_mat</cite> represents the coordinates of a single atom. The
1st column sets the coordinates of the atom with id of 0.
The next column sets the coordinates of the atom with id 1,
and so on.</p>
</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.shift">
<code class="descname">shift</code><span class="sig-paren">(</span><em>shift</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Shifts the coordinates of all atoms.</p>
<p>This does not modify the molecule. A modified copy is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>shift</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A numpy array holding the value of the shift along each
axis.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A copy of the molecule where the coordinates have been
shifted by <cite>shift</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.shift_fgs">
<code class="descname">shift_fgs</code><span class="sig-paren">(</span><em>new_ids</em>, <em>shift</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.shift_fgs" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield new functional groups with atomic ids shifted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>new_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids assigned to the new functional groups.</li>
<li><strong>num_atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number to shift each atom id by.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last"><a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a> – A functional group from <a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit.func_groups" title="stk.molecular.molecules.struct_unit.StructUnit.func_groups"><code class="xref py py-attr docutils literal notranslate"><span class="pre">func_groups</span></code></a>
with atomic ids shifted by <cite>shift</cite>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.similar_molecules">
<code class="descname">similar_molecules</code><span class="sig-paren">(</span><em>mols</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.similar_molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns molecules from <cite>mols</cite> ordered by similarity.</p>
<p>The most similar molecule is at index 0.</p>
<p>This method uses the Morgan fingerprints of radius 4 to
evaluate how similar the molecules in <cite>mols</cite> are.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mols</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code>) – A group of molecules to which similarity is compared.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of the form,<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">returned_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">8.9</span><span class="p">,</span> <span class="n">mol1</span><span class="p">),</span> <span class="p">(</span><span class="mf">7.3</span><span class="p">,</span> <span class="n">mol2</span><span class="p">),</span> <span class="p">(</span><span class="mf">3.4</span><span class="p">,</span> <span class="n">mol3</span><span class="p">)]</span>
</pre></div>
</div>
<p>where the <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code> is the similarity of a given
molecule in <cite>mols</cite> while the <code class="docutils literal notranslate"><span class="pre">`mol</span></code> is corresponding
<code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule. Most similar molecule yielded first.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.smiles_init">
<em class="property">classmethod </em><code class="descname">smiles_init</code><span class="sig-paren">(</span><em>smiles</em>, <em>functional_groups=None</em>, <em>random_seed=4</em>, <em>note=''</em>, <em>name=''</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.smiles_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize from a SMILES string.</p>
<p>The structure of the molecule is embedded using
<code class="xref py py-func docutils literal notranslate"><span class="pre">rdkit.ETKDG()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>smiles</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – A SMILES string of the molecule.</li>
<li><strong>functional_groups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The name of the functional groups which are to have atoms
tagged. If no functional groups are provided to this
parameter, no tagging is done.</li>
<li><strong>random_seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – Random seed passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">rdkit.ETKDG()</span></code></li>
<li><strong>note</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – A note or comment about the molecule.</li>
<li><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – A name which can be optionally given to the molcule for
easy identification.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A <a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> instance of the molecule in <cite>smarts</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.subclasses">
<code class="descname">subclasses</code><em class="property"> = {'Cage': &lt;class 'stk.molecular.molecules.cage.Cage'&gt;, 'CageComplex': &lt;class 'stk.molecular.molecules.cage.CageComplex'&gt;, 'CageStructUnit': &lt;class 'stk.molecular.molecules.cage.CageStructUnit'&gt;, 'MacroMolecule': &lt;class 'stk.molecular.molecules.macro_molecule.MacroMolecule'&gt;, 'Macrocycle': &lt;class 'stk.molecular.molecules.macrocycle.Macrocycle'&gt;, 'MacrocycleStructUnit': &lt;class 'stk.molecular.molecules.macrocycle.MacrocycleStructUnit'&gt;, 'Periodic': &lt;class 'stk.molecular.molecules.periodic.Periodic'&gt;, 'Polymer': &lt;class 'stk.molecular.molecules.polymer.Polymer'&gt;, 'Rotaxane': &lt;class 'stk.molecular.molecules.rotaxane.Rotaxane'&gt;, 'StructUnit': &lt;class 'stk.molecular.molecules.struct_unit.StructUnit'&gt;, 'StructUnit2': &lt;class 'stk.molecular.molecules.struct_unit.StructUnit2'&gt;, 'StructUnit3': &lt;class 'stk.molecular.molecules.struct_unit.StructUnit3'&gt;}</em><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.subclasses" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.update_cache">
<code class="descname">update_cache</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.update_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Update attributes of cached molecule.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code> returns modified copies of molecules.
In order to ensure that the cached molecules have
their attributes updated to the values of the copies, this
method must be run on the copies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.update_from_mae">
<code class="descname">update_from_mae</code><span class="sig-paren">(</span><em>path</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.update_from_mae" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates molecular structure to match an <code class="docutils literal notranslate"><span class="pre">.mae</span></code> file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path of the <code class="docutils literal notranslate"><span class="pre">.mae</span></code> file from which the structure
should be updated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to be updated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.update_from_mol">
<code class="descname">update_from_mol</code><span class="sig-paren">(</span><em>path</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.update_from_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates molecular structure to match an <code class="docutils literal notranslate"><span class="pre">.mol</span></code> file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path of the <code class="docutils literal notranslate"><span class="pre">.mol</span></code> file from which the structure
should be updated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to be updated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.update_from_xyz">
<code class="descname">update_from_xyz</code><span class="sig-paren">(</span><em>path</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.update_from_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates molecular structure to match a <code class="docutils literal notranslate"><span class="pre">.xyz</span></code> file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path of the <code class="docutils literal notranslate"><span class="pre">.mol</span></code> file from which the structure
should be updated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to be updated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code> – If the number of atoms in the file does not match the
number of atoms in the molecule or if atom elements in the
file do not agree with the atom elements in the molecule.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.update_stereochemistry">
<code class="descname">update_stereochemistry</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.update_stereochemistry" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates stereochemistry tags in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Molecule.mol</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>path</em>, <em>atoms=None</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a molecular structure file of the molecule.</p>
<p>This bypasses the need for writing functions in <code class="docutils literal notranslate"><span class="pre">rdkit</span></code>.
These have issues with macromolecules due to poor ring finding
and sanitization issues.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The <cite>path</cite> to which the molecule should be written.</li>
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2">
<em class="property">class </em><code class="descclassname">stk.molecular.molecules.struct_unit.</code><code class="descname">StructUnit2</code><span class="sig-paren">(</span><em>mol</em>, <em>functional_groups=None</em>, <em>name=''</em>, <em>note=''</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">stk.molecular.molecules.struct_unit.StructUnit</span></code></a></p>
<p>Represents building blocks with 2 functional groups.</p>
<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>mol</em>, <em>functional_groups=None</em>, <em>name=''</em>, <em>note=''</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a <a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code>) – <p>Can be one of 3 things:</p>
<blockquote>
<div><ol class="arabic">
<li>A path to a molecular structure file.</li>
<li>A <code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code> object.</li>
<li>V3000 MDL Mol block.</li>
</ol>
</div></blockquote>
</li>
<li><strong>functional_groups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of the functional groups which are to have atoms
tagged. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a functional group name found in the
path <cite>file</cite>  is used. If no functional groups are provided
to this parameter and the name of one is not present in
<cite>file</cite>, no tagging is done.</li>
<li><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – A name which can be optionally given to the molecule for
easy identification.</li>
<li><strong>note</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – A note or comment about the molecule.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2._json_init">
<em class="property">classmethod </em><code class="descname">_json_init</code><span class="sig-paren">(</span><em>json_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2._json_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Completes a JSON initialization.</p>
<p>This function is not to be used. Use <code class="xref py py-meth docutils literal notranslate"><span class="pre">Molecule.load()</span></code>
for loading instances from a JSON string. That function will
automatically call this one.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>json_dict</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – A dictionary holding the attribute data of the molecule.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2._set_orientation2">
<code class="descname">_set_orientation2</code><span class="sig-paren">(</span><em>start</em>, <em>end</em>, <em>conformer</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2._set_orientation2" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule by a rotation from <cite>start</cite> to <cite>end</cite>.</p>
<p>Given two direction vectors, <cite>start</cite> and <cite>end</cite>, this method
applies the rotation required transform <cite>start</cite> to <cite>end</cite> on
the molecule. The rotation occurs about the centroid of the
molecule.</p>
<p>For example, if the <cite>start</cite> and <cite>end</cite> vectors
are 45 degrees apart, a 45 degree rotation will be applied to
the molecule. The rotation will be along the appropriate
direction.</p>
<p>The great thing about this method is that you as long as you
can associate a gemotric feature of the molecule with a vector,
then the molecule can be roatated so that this vector is
aligned with <cite>end</cite>. The defined vector can be virtually
anything. This means that any geometric feature of the molecule
can be easily aligned with any arbitrary axis.</p>
<p class="rubric">Notes</p>
<p>The difference between this method and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">set_orientation()</span></code> is about which point the
rotation occurs: centroid of bonder atoms versus centroid of
entire molecule, respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A vector which is to be rotated so that it transforms to
the <cite>end</cite> vector.</li>
<li><strong>end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – This array holds the vector, onto which <cite>start</cite> is rotated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2._write_mdl_mol_file">
<code class="descname">_write_mdl_mol_file</code><span class="sig-paren">(</span><em>path</em>, <em>atoms</em>, <em>conformer</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2._write_mdl_mol_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a V3000 <code class="docutils literal notranslate"><span class="pre">.mol</span></code> file of the molecule</p>
<p>This function should not be used directly, only via
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit2.write" title="stk.molecular.molecules.struct_unit.StructUnit2.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file being written.</li>
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2._write_pdb_file">
<code class="descname">_write_pdb_file</code><span class="sig-paren">(</span><em>path</em>, <em>atoms</em>, <em>conformer</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2._write_pdb_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <code class="docutils literal notranslate"><span class="pre">.pdb</span></code> file of the molecule</p>
<p>This function should not be used directly, only via
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit2.write" title="stk.molecular.molecules.struct_unit.StructUnit2.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file being written.</li>
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2._write_xyz_file">
<code class="descname">_write_xyz_file</code><span class="sig-paren">(</span><em>path</em>, <em>atoms</em>, <em>conformer</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2._write_xyz_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <code class="docutils literal notranslate"><span class="pre">.xyz</span></code> file of the molecule</p>
<p>This function should not be used directly, only via
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit2.write" title="stk.molecular.molecules.struct_unit.StructUnit2.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file being written.</li>
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.all_atom_coords">
<code class="descname">all_atom_coords</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.all_atom_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields the coordinates of atoms in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> – The yielded <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> has the form</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
</pre></div>
</div>
<p class="last">Where the first element is the atom id and the second
element is an array holding the coordinates of the atom.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.all_bonder_distances">
<code class="descname">all_bonder_distances</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.all_bonder_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield distances between all pairs of bonder centroids.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of the form <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">54,</span> <span class="pre">12.54)</span></code>.
The first two elements are the ids of the involved
functional groups and the third element is the distance
between them.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.atom_centroid">
<code class="descname">atom_centroid</code><span class="sig-paren">(</span><em>atom_ids</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.atom_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the centroid of a group of atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of atoms which which are used to calculate the
centroid.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The centroid of atoms specified by <cite>atom_ids</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.atom_coords">
<code class="descname">atom_coords</code><span class="sig-paren">(</span><em>atom_id</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.atom_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Return coordinates of an atom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the atom whose coordinates are desired.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An array holding the x, y and z coordinates of the atom.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.atom_distance">
<code class="descname">atom_distance</code><span class="sig-paren">(</span><em>atom1_id</em>, <em>atom2_id</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.atom_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the distance between 2 atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom1_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the first atom.</li>
<li><strong>atom2_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the second atom.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The distance between the first and second atoms.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.double</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.atom_symbol">
<code class="descname">atom_symbol</code><span class="sig-paren">(</span><em>atom_id</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.atom_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the symbol of the atom with id <cite>atom_id</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id number of the atom.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The atomic symbol of the atom.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.bonder_centroid">
<code class="descname">bonder_centroid</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.bonder_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the centroid of the bonder atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An array holding the midpoint of the bonder atoms.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.bonder_centroids">
<code class="descname">bonder_centroids</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.bonder_centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the centriod of bonder atoms in each fg.</p>
<p>The centroids are yielded in order, with the centroid of
the functional group with an id of <code class="docutils literal notranslate"><span class="pre">0</span></code> first.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> – The bonder centroid of a functional group.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.bonder_direction_vectors">
<code class="descname">bonder_direction_vectors</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.bonder_direction_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields the direction vectors between bonder atoms.</p>
<p>First the centroids of bonder atoms within the same functional
group are found. Then direction vectors between all pairs of
these centroids are yielded. Each pair is only yielded once.</p>
<p>The yielded vector is normalized.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> – They yielded tuple has the form</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.2</span><span class="p">,</span> <span class="mf">43.3</span><span class="p">,</span> <span class="mf">9.78</span><span class="p">]))</span>
</pre></div>
</div>
<p class="last">The first two elements of the tuple represent the ids
of the start and end fgs of the vector, respectively. The
array is the direction vector running between the
functional group positions.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.bonder_position_matrix">
<code class="descname">bonder_position_matrix</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.bonder_position_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a matrix holding the positions of bonder centroids.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The array has the shape <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">n]</span></code>. Each column holds the
x, y and z coordinates of a bonder centroid. The index of
the column corresponds to the id of the functional group.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.cache">
<code class="descname">cache</code><em class="property"> = {}</em><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.center_of_mass">
<code class="descname">center_of_mass</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.center_of_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the centre of mass of the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An array holding the coordinates of the center of mass.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Center_of_mass">https://en.wikipedia.org/wiki/Center_of_mass</a></p>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.centroid">
<code class="descname">centroid</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the centroid of the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A numpy array holding the position of the centroid.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.centroid_centroid_dir_vector">
<code class="descname">centroid_centroid_dir_vector</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.centroid_centroid_dir_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the direction vector between the 2 molecular centroids.</p>
<p>The first molecular centroid is the centroid of the entire
molecule. The second molecular centroid is given by
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit2.bonder_centroid" title="stk.molecular.molecules.struct_unit.StructUnit2.bonder_centroid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bonder_centroid()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The normalized direction vector running from the centroid
of the bonder atoms to the molecular centroid.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.core">
<code class="descname">core</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.core" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the molecule with no H or functional group atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The “core” of the molecule.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.dihedral_strain">
<code class="descname">dihedral_strain</code><span class="sig-paren">(</span><em>dihedral_SMARTS=''</em>, <em>target=180</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.dihedral_strain" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the difference between the average dihedral and target.</p>
<p>The differences is a returned as a percent.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dihedral_SMARTS</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The SMARTS code for the dihedral of interest.</li>
<li><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Float representing the target value for the dihedral angle.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The percent difference between the average dihedral in the
molecule and the target value.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.direction">
<code class="descname">direction</code><span class="sig-paren">(</span><em>exclude_ids=None</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.direction" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the direction of the molecule or its atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>excluded_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of atoms exluded from the direction calculation.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Direction vector of the molecule (excluding <cite>exclude_ids</cite>).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.dump">
<code class="descname">dump</code><span class="sig-paren">(</span><em>path</em>, <em>include_attrs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a JSON <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> of the molecule to a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file to which the JSON dict should be
written.</li>
<li><strong>include_attrs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of attributes of the molecule to be added to
the JSON. Each attribute is saved as a string using
<code class="xref py py-func docutils literal notranslate"><span class="pre">repr()</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.fg_bonder_centroid">
<code class="descname">fg_bonder_centroid</code><span class="sig-paren">(</span><em>fg_id</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.fg_bonder_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>The centroid of bonder atoms in a functional group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fg_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the functional group.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The coordinates of a bonder centroid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.fg_distance">
<code class="descname">fg_distance</code><span class="sig-paren">(</span><em>fg1</em>, <em>fg2</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.fg_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>The distance between the bonder centroids of two fgs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fg1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The <code class="docutils literal notranslate"><span class="pre">fg_id</span></code> of the first fg.</li>
<li><strong>fg2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The <code class="docutils literal notranslate"><span class="pre">fg_id</span></code> of the second fg.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The distance between <cite>fg1</cite> and <cite>fg2</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.from_dict">
<em class="property">classmethod </em><code class="descname">from_dict</code><span class="sig-paren">(</span><em>json_dict</em>, <em>load_names=True</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> from a JSON <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> returned has the class specified in
<cite>json_dict</cite>, not <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>json_dict</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – A <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> holding the JSON representation of a
molecule.</li>
<li><strong>load_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> then the <code class="docutils literal notranslate"><span class="pre">name</span></code> key stored in <cite>json_dict</cite>
is loaded.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The molecule represented by <cite>json_dict</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.functional_groups">
<code class="descname">functional_groups</code><span class="sig-paren">(</span><em>fg_names</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.functional_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds given functional groups in the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fg_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The names of functional groups which are to be found
within the molecule.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> holding a <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup`</span></code>
instance for every matched functional group in the
molecule.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.gen_key">
<em class="property">static </em><code class="descname">gen_key</code><span class="sig-paren">(</span><em>rdkit_mol</em>, <em>functional_groups</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.gen_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the key used when caching the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rdkit_mol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code>) – An <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> instance of the molecule.</li>
<li><strong>functional_groups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The name of the functional groups being used to make
macromolecules.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>The key used for caching the molecule. Has the form</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s1">&#39;amine&#39;</span><span class="p">,</span> <span class="s1">&#39;bromine&#39;</span><span class="p">,</span> <span class="s1">&#39;InChIString&#39;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.graph">
<code class="descname">graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a mathematical graph representing the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A graph where the nodes are the ids of the atoms and the
edges are the bonds.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">networkx.Graph</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.inchi">
<code class="descname">inchi</code><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.inchi" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the InChI of the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The InChI of the molecule.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.init_funcs">
<code class="descname">init_funcs</code><em class="property"> = {'.mae': &lt;function mol_from_mae_file&gt;, '.mol': functools.partial(&lt;Boost.Python.function object&gt;, sanitize=False, removeHs=False), '.mol2': functools.partial(&lt;Boost.Python.function object&gt;, sanitize=False, removeHs=False), '.pdb': functools.partial(&lt;Boost.Python.function object&gt;, sanitize=False, removeHs=False), '.sdf': functools.partial(&lt;Boost.Python.function object&gt;, sanitize=False, removeHs=False)}</em><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.init_funcs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.init_random">
<em class="property">classmethod </em><code class="descname">init_random</code><span class="sig-paren">(</span><em>db</em>, <em>functional_groups=None</em>, <em>name=''</em>, <em>note=''</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.init_random" title="Permalink to this definition">¶</a></dt>
<dd><p>Picks a random file from <cite>db</cite> to initialize from.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>db</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – A path to a database of molecular files.</li>
<li><strong>functional_groups</strong> (:class`list` of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The name of a functional groups which the molecules in <cite>db</cite>
have. By default it is assumed the name is present in the
path of the files.</li>
<li><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The name to be given to the created molecule.</li>
<li><strong>note</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – A note to be given to the created molecule.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A random molecule from <cite>db</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code> – If no files in <cite>db</cite> could be initialized from.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.is_core_atom">
<code class="descname">is_core_atom</code><span class="sig-paren">(</span><em>atom_id</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.is_core_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if atom is not H or part of a fg.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the atom being queried.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Indicates whether the atom with <cite>atom_id</cite> is part of the
core.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.json">
<code class="descname">json</code><span class="sig-paren">(</span><em>include_attrs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.json" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a JSON representation of the molecule.</p>
<p>The representation has the following form:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;class&#39;</span> <span class="p">:</span> <span class="s1">&#39;StructUnit&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mol_block&#39;</span> <span class="p">:</span> <span class="s1">&#39;&#39;&#39;A string holding the V3000 mol</span>
<span class="s1">                     block of the molecule.&#39;&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;note&#39;</span> <span class="p">:</span> <span class="s1">&#39;This molecule is nice.&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;benzene&#39;</span><span class="p">,</span>
    <span class="s1">&#39;atom_props&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;prop1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                       <span class="s1">&#39;prop2&#39;</span><span class="p">:</span> <span class="s1">&#39;value1&#39;</span><span class="p">}}</span>
<span class="p">}</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>include_attrs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of attributes of the molecule to be added to
the JSON. Each attribute is saved as a string using
<code class="xref py py-func docutils literal notranslate"><span class="pre">repr()</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> which represents the molecule.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.load">
<em class="property">classmethod </em><code class="descname">load</code><span class="sig-paren">(</span><em>path</em>, <em>load_names=True</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> from a JSON file.</p>
<p>The returned <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> has the class specified in the
JSON file, not <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path holding a JSON representation to a molecule.</li>
<li><strong>load_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> then the <code class="docutils literal notranslate"><span class="pre">name</span></code> key stored in the JSON file
is loaded.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The molecule held in <cite>path</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.max_diameter">
<code class="descname">max_diameter</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.max_diameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the largest distance between 2 atoms in the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of the form<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">max_diameter</span> <span class="o">=</span> <span class="p">(</span><span class="mf">312.3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">54</span><span class="p">)</span>
</pre></div>
</div>
<p>Where the first element is the largest inter-atomic
distance in the molecule. The next 2 elements are the ids
of the involved atoms.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of form (float, int, int)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.mdl_mol_block">
<code class="descname">mdl_mol_block</code><span class="sig-paren">(</span><em>atoms=None</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.mdl_mol_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a V3000 mol block of the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The V3000 mol block representing the molecule.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.minimize_theta">
<code class="descname">minimize_theta</code><span class="sig-paren">(</span><em>v1</em>, <em>v2</em>, <em>axis</em>, <em>centroid</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.minimize_theta" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule to minimize angle between <cite>v1</cite> and <cite>v2</cite>.</p>
<p>The rotation is done about the vector <cite>axis</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>v1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector which is rotated.</li>
<li><strong>v2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector which is stationary.</li>
<li><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector about which the rotation happens.</li>
<li><strong>centroid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The position vector at the center of the rotation.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.minimize_theta2">
<code class="descname">minimize_theta2</code><span class="sig-paren">(</span><em>vector</em>, <em>axis</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.minimize_theta2" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates molecule about <cite>axis</cite> to minimze theta with <cite>vector</cite>.</p>
<p>The molecule is rotated about <cite>axis</cite> passing through the bonder
centroid. It is rotated so that the vector between the bonder
and molecular centroids lies on the same plane as <cite>vector</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vector</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector to which the distance should be minimized.</li>
<li><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The direction vector along which the rotation happens.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.plane_normal">
<code class="descname">plane_normal</code><span class="sig-paren">(</span><em>atom_ids=None</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.plane_normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the best fit plane of the molecule or its atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The ids of the atoms that are assumed to be on the plane.
Only their coordinates will be used for fitting.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> then atoms forming the largest cycle are found
prior to fitting the plane.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Vector orthonormal to the plane of the molecule.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.position_matrix">
<code class="descname">position_matrix</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.position_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a matrix holding the atomic positions of a conformer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The array has the shape <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">n]</span></code>. Each column holds the
x, y and z coordinates of a bonder centroid. The index of
the column corresponds to the atom id.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>theta</em>, <em>axis</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule by <cite>theta</cite> about <cite>axis</cite>.</p>
<p>The rotation occurs about the molecular centroid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>theta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The size of the rotation in radians.</li>
<li><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The axis about which the rotation happens.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.rotate2">
<code class="descname">rotate2</code><span class="sig-paren">(</span><em>theta</em>, <em>axis</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.rotate2" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule by <cite>theta</cite> about <cite>axis</cite>.</p>
<p>The rotation occurs about the centroid of the bonder atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>theta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The size of the rotation in radians.</li>
<li><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The axis about which rotation happens.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.same">
<code class="descname">same</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.same" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <cite>other</cite> has the same molecular structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>) – The <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> instance you are checking has
the same structure.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the structures match.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.save_rdkit_atom_props">
<code class="descname">save_rdkit_atom_props</code><span class="sig-paren">(</span><em>prop_names</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.save_rdkit_atom_props" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates <a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule.atom_props" title="stk.molecular.molecules.molecule.Molecule.atom_props"><code class="xref py py-attr docutils literal notranslate"><span class="pre">atom_props</span></code></a> with rdkit atom tags.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>prop_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The names of atom properties which should be saved.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.set_bonder_centroid">
<code class="descname">set_bonder_centroid</code><span class="sig-paren">(</span><em>position</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.set_bonder_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Move the molecule so that the bonder centroid is on <cite>position</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>position</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – An array holding the desired the position. It holds
the x, y and z coordinates, respectively.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule after it has been shifted. The same
instance as in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.set_orientation">
<code class="descname">set_orientation</code><span class="sig-paren">(</span><em>start</em>, <em>end</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.set_orientation" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule by a rotation from <cite>start</cite> to <cite>end</cite>.</p>
<p>Given two direction vectors, <cite>start</cite> and <cite>end</cite>, this method
applies the rotation required transform <cite>start</cite> to <cite>end</cite> on
the molecule. The rotation occurs about the centroid of the
molecule.</p>
<p>For example, if the <cite>start</cite> and <cite>end</cite> vectors
are 45 degrees apart, a 45 degree rotation will be applied to
the molecule. The rotation will be along the appropriate
direction.</p>
<p>The great thing about this method is that you as long as you
can associate a geometric feature of the molecule with a
vector, then the molecule can be rotated so that this vector is
aligned with <cite>end</cite>. The defined vector can be virtually
anything. This means that any geometric feature of the molecule
can be easily aligned with any arbitrary axis.</p>
<p class="rubric">Notes</p>
<p>The difference between this method and
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit._set_orientation2" title="stk.molecular.molecules.struct_unit.StructUnit._set_orientation2"><code class="xref py py-meth docutils literal notranslate"><span class="pre">StructUnit._set_orientation2()</span></code></a> is about which point the
rotation occurs: centroid of the entire molecule versus
centroid of the bonder atoms, respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A vector which is to be rotated so that it transforms to
the <cite>end</cite> vector.</li>
<li><strong>end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – This array holds the vector, onto which <cite>start</cite> is rotated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.set_orientation2">
<code class="descname">set_orientation2</code><span class="sig-paren">(</span><em>end</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.set_orientation2" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate the molecule so that bonder atoms lie on <cite>end</cite>.</p>
<p>The molecule is rotated about the centroid of the bonder atoms.
It is rotated so that the direction vector running between the
2 bonder centroids is aligned with the vector <cite>end</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector with which the molecule’s bonder atoms should be
aligned.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.set_position">
<code class="descname">set_position</code><span class="sig-paren">(</span><em>position</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.set_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the centroid of the molecule to <cite>position</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>position</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – This array holds the position on which the centroid of the
molecule should be placed.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule with the centroid placed at
<cite>position</cite>. This is the same instance as that in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Molecule.mol</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.set_position_from_matrix">
<code class="descname">set_position_from_matrix</code><span class="sig-paren">(</span><em>pos_mat</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.set_position_from_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Set atomic positions of the molecule to those in <cite>pos_mat</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pos_mat</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – <p>The matrix holds the coordinates on which the atoms of the
molecule should be placed.</p>
<p>The shape of the matrix is <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">n]</span></code>. Each column of
<cite>pos_mat</cite> represents the coordinates of a single atom. The
1st column sets the coordinates of the atom with id of 0.
The next column sets the coordinates of the atom with id 1,
and so on.</p>
</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.shift">
<code class="descname">shift</code><span class="sig-paren">(</span><em>shift</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Shifts the coordinates of all atoms.</p>
<p>This does not modify the molecule. A modified copy is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>shift</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A numpy array holding the value of the shift along each
axis.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A copy of the molecule where the coordinates have been
shifted by <cite>shift</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.shift_fgs">
<code class="descname">shift_fgs</code><span class="sig-paren">(</span><em>new_ids</em>, <em>shift</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.shift_fgs" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield new functional groups with atomic ids shifted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>new_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids assigned to the new functional groups.</li>
<li><strong>num_atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number to shift each atom id by.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last"><a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a> – A functional group from <a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit.func_groups" title="stk.molecular.molecules.struct_unit.StructUnit.func_groups"><code class="xref py py-attr docutils literal notranslate"><span class="pre">func_groups</span></code></a>
with atomic ids shifted by <cite>shift</cite>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.similar_molecules">
<code class="descname">similar_molecules</code><span class="sig-paren">(</span><em>mols</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.similar_molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns molecules from <cite>mols</cite> ordered by similarity.</p>
<p>The most similar molecule is at index 0.</p>
<p>This method uses the Morgan fingerprints of radius 4 to
evaluate how similar the molecules in <cite>mols</cite> are.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mols</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code>) – A group of molecules to which similarity is compared.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of the form,<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">returned_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">8.9</span><span class="p">,</span> <span class="n">mol1</span><span class="p">),</span> <span class="p">(</span><span class="mf">7.3</span><span class="p">,</span> <span class="n">mol2</span><span class="p">),</span> <span class="p">(</span><span class="mf">3.4</span><span class="p">,</span> <span class="n">mol3</span><span class="p">)]</span>
</pre></div>
</div>
<p>where the <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code> is the similarity of a given
molecule in <cite>mols</cite> while the <code class="docutils literal notranslate"><span class="pre">`mol</span></code> is corresponding
<code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule. Most similar molecule yielded first.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.smiles_init">
<em class="property">classmethod </em><code class="descname">smiles_init</code><span class="sig-paren">(</span><em>smiles</em>, <em>functional_groups=None</em>, <em>random_seed=4</em>, <em>note=''</em>, <em>name=''</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.smiles_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize from a SMILES string.</p>
<p>The structure of the molecule is embedded using
<code class="xref py py-func docutils literal notranslate"><span class="pre">rdkit.ETKDG()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>smiles</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – A SMILES string of the molecule.</li>
<li><strong>functional_groups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The name of the functional groups which are to have atoms
tagged. If no functional groups are provided to this
parameter, no tagging is done.</li>
<li><strong>random_seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – Random seed passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">rdkit.ETKDG()</span></code></li>
<li><strong>note</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – A note or comment about the molecule.</li>
<li><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – A name which can be optionally given to the molcule for
easy identification.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A <a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> instance of the molecule in <cite>smarts</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.subclasses">
<code class="descname">subclasses</code><em class="property"> = {'Cage': &lt;class 'stk.molecular.molecules.cage.Cage'&gt;, 'CageComplex': &lt;class 'stk.molecular.molecules.cage.CageComplex'&gt;, 'CageStructUnit': &lt;class 'stk.molecular.molecules.cage.CageStructUnit'&gt;, 'MacroMolecule': &lt;class 'stk.molecular.molecules.macro_molecule.MacroMolecule'&gt;, 'Macrocycle': &lt;class 'stk.molecular.molecules.macrocycle.Macrocycle'&gt;, 'MacrocycleStructUnit': &lt;class 'stk.molecular.molecules.macrocycle.MacrocycleStructUnit'&gt;, 'Periodic': &lt;class 'stk.molecular.molecules.periodic.Periodic'&gt;, 'Polymer': &lt;class 'stk.molecular.molecules.polymer.Polymer'&gt;, 'Rotaxane': &lt;class 'stk.molecular.molecules.rotaxane.Rotaxane'&gt;, 'StructUnit': &lt;class 'stk.molecular.molecules.struct_unit.StructUnit'&gt;, 'StructUnit2': &lt;class 'stk.molecular.molecules.struct_unit.StructUnit2'&gt;, 'StructUnit3': &lt;class 'stk.molecular.molecules.struct_unit.StructUnit3'&gt;}</em><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.subclasses" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.update_cache">
<code class="descname">update_cache</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.update_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Update attributes of cached molecule.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code> returns modified copies of molecules.
In order to ensure that the cached molecules have
their attributes updated to the values of the copies, this
method must be run on the copies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.update_from_mae">
<code class="descname">update_from_mae</code><span class="sig-paren">(</span><em>path</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.update_from_mae" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates molecular structure to match an <code class="docutils literal notranslate"><span class="pre">.mae</span></code> file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path of the <code class="docutils literal notranslate"><span class="pre">.mae</span></code> file from which the structure
should be updated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to be updated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.update_from_mol">
<code class="descname">update_from_mol</code><span class="sig-paren">(</span><em>path</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.update_from_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates molecular structure to match an <code class="docutils literal notranslate"><span class="pre">.mol</span></code> file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path of the <code class="docutils literal notranslate"><span class="pre">.mol</span></code> file from which the structure
should be updated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to be updated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.update_from_xyz">
<code class="descname">update_from_xyz</code><span class="sig-paren">(</span><em>path</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.update_from_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates molecular structure to match a <code class="docutils literal notranslate"><span class="pre">.xyz</span></code> file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path of the <code class="docutils literal notranslate"><span class="pre">.mol</span></code> file from which the structure
should be updated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to be updated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code> – If the number of atoms in the file does not match the
number of atoms in the molecule or if atom elements in the
file do not agree with the atom elements in the molecule.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.update_stereochemistry">
<code class="descname">update_stereochemistry</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.update_stereochemistry" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates stereochemistry tags in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Molecule.mol</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit2.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>path</em>, <em>atoms=None</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit2.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a molecular structure file of the molecule.</p>
<p>This bypasses the need for writing functions in <code class="docutils literal notranslate"><span class="pre">rdkit</span></code>.
These have issues with macromolecules due to poor ring finding
and sanitization issues.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The <cite>path</cite> to which the molecule should be written.</li>
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3">
<em class="property">class </em><code class="descclassname">stk.molecular.molecules.struct_unit.</code><code class="descname">StructUnit3</code><span class="sig-paren">(</span><em>mol</em>, <em>functional_groups=None</em>, <em>name=''</em>, <em>note=''</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">stk.molecular.molecules.struct_unit.StructUnit</span></code></a></p>
<p>Represents building blocks with 3 or more functional groups.</p>
<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>mol</em>, <em>functional_groups=None</em>, <em>name=''</em>, <em>note=''</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a <a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code>) – <p>Can be one of 3 things:</p>
<blockquote>
<div><ol class="arabic">
<li>A path to a molecular structure file.</li>
<li>A <code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code> object.</li>
<li>V3000 MDL Mol block.</li>
</ol>
</div></blockquote>
</li>
<li><strong>functional_groups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of the functional groups which are to have atoms
tagged. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a functional group name found in the
path <cite>file</cite>  is used. If no functional groups are provided
to this parameter and the name of one is not present in
<cite>file</cite>, no tagging is done.</li>
<li><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – A name which can be optionally given to the molecule for
easy identification.</li>
<li><strong>note</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – A note or comment about the molecule.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3._json_init">
<em class="property">classmethod </em><code class="descname">_json_init</code><span class="sig-paren">(</span><em>json_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3._json_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Completes a JSON initialization.</p>
<p>This function is not to be used. Use <code class="xref py py-meth docutils literal notranslate"><span class="pre">Molecule.load()</span></code>
for loading instances from a JSON string. That function will
automatically call this one.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>json_dict</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – A dictionary holding the attribute data of the molecule.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3._set_orientation2">
<code class="descname">_set_orientation2</code><span class="sig-paren">(</span><em>start</em>, <em>end</em>, <em>conformer</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3._set_orientation2" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule by a rotation from <cite>start</cite> to <cite>end</cite>.</p>
<p>Given two direction vectors, <cite>start</cite> and <cite>end</cite>, this method
applies the rotation required transform <cite>start</cite> to <cite>end</cite> on
the molecule. The rotation occurs about the centroid of the
molecule.</p>
<p>For example, if the <cite>start</cite> and <cite>end</cite> vectors
are 45 degrees apart, a 45 degree rotation will be applied to
the molecule. The rotation will be along the appropriate
direction.</p>
<p>The great thing about this method is that you as long as you
can associate a gemotric feature of the molecule with a vector,
then the molecule can be roatated so that this vector is
aligned with <cite>end</cite>. The defined vector can be virtually
anything. This means that any geometric feature of the molecule
can be easily aligned with any arbitrary axis.</p>
<p class="rubric">Notes</p>
<p>The difference between this method and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">set_orientation()</span></code> is about which point the
rotation occurs: centroid of bonder atoms versus centroid of
entire molecule, respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A vector which is to be rotated so that it transforms to
the <cite>end</cite> vector.</li>
<li><strong>end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – This array holds the vector, onto which <cite>start</cite> is rotated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3._write_mdl_mol_file">
<code class="descname">_write_mdl_mol_file</code><span class="sig-paren">(</span><em>path</em>, <em>atoms</em>, <em>conformer</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3._write_mdl_mol_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a V3000 <code class="docutils literal notranslate"><span class="pre">.mol</span></code> file of the molecule</p>
<p>This function should not be used directly, only via
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit3.write" title="stk.molecular.molecules.struct_unit.StructUnit3.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file being written.</li>
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3._write_pdb_file">
<code class="descname">_write_pdb_file</code><span class="sig-paren">(</span><em>path</em>, <em>atoms</em>, <em>conformer</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3._write_pdb_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <code class="docutils literal notranslate"><span class="pre">.pdb</span></code> file of the molecule</p>
<p>This function should not be used directly, only via
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit3.write" title="stk.molecular.molecules.struct_unit.StructUnit3.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file being written.</li>
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3._write_xyz_file">
<code class="descname">_write_xyz_file</code><span class="sig-paren">(</span><em>path</em>, <em>atoms</em>, <em>conformer</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3._write_xyz_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <code class="docutils literal notranslate"><span class="pre">.xyz</span></code> file of the molecule</p>
<p>This function should not be used directly, only via
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit3.write" title="stk.molecular.molecules.struct_unit.StructUnit3.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file being written.</li>
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.all_atom_coords">
<code class="descname">all_atom_coords</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.all_atom_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields the coordinates of atoms in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> – The yielded <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> has the form</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
</pre></div>
</div>
<p class="last">Where the first element is the atom id and the second
element is an array holding the coordinates of the atom.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.all_bonder_distances">
<code class="descname">all_bonder_distances</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.all_bonder_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield distances between all pairs of bonder centroids.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of the form <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">54,</span> <span class="pre">12.54)</span></code>.
The first two elements are the ids of the involved
functional groups and the third element is the distance
between them.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.atom_centroid">
<code class="descname">atom_centroid</code><span class="sig-paren">(</span><em>atom_ids</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.atom_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the centroid of a group of atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of atoms which which are used to calculate the
centroid.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The centroid of atoms specified by <cite>atom_ids</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.atom_coords">
<code class="descname">atom_coords</code><span class="sig-paren">(</span><em>atom_id</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.atom_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Return coordinates of an atom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the atom whose coordinates are desired.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An array holding the x, y and z coordinates of the atom.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.atom_distance">
<code class="descname">atom_distance</code><span class="sig-paren">(</span><em>atom1_id</em>, <em>atom2_id</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.atom_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the distance between 2 atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom1_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the first atom.</li>
<li><strong>atom2_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the second atom.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The distance between the first and second atoms.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.double</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.atom_symbol">
<code class="descname">atom_symbol</code><span class="sig-paren">(</span><em>atom_id</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.atom_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the symbol of the atom with id <cite>atom_id</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id number of the atom.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The atomic symbol of the atom.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.bonder_centroid">
<code class="descname">bonder_centroid</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.bonder_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the centroid of the bonder atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An array holding the midpoint of the bonder atoms.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.bonder_centroids">
<code class="descname">bonder_centroids</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.bonder_centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the centriod of bonder atoms in each fg.</p>
<p>The centroids are yielded in order, with the centroid of
the functional group with an id of <code class="docutils literal notranslate"><span class="pre">0</span></code> first.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> – The bonder centroid of a functional group.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.bonder_direction_vectors">
<code class="descname">bonder_direction_vectors</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.bonder_direction_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields the direction vectors between bonder atoms.</p>
<p>First the centroids of bonder atoms within the same functional
group are found. Then direction vectors between all pairs of
these centroids are yielded. Each pair is only yielded once.</p>
<p>The yielded vector is normalized.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> – They yielded tuple has the form</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.2</span><span class="p">,</span> <span class="mf">43.3</span><span class="p">,</span> <span class="mf">9.78</span><span class="p">]))</span>
</pre></div>
</div>
<p class="last">The first two elements of the tuple represent the ids
of the start and end fgs of the vector, respectively. The
array is the direction vector running between the
functional group positions.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.bonder_plane">
<code class="descname">bonder_plane</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.bonder_plane" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns coeffs of the plane formed by the bonder centroids.</p>
<p>A plane is defined by the scalar plane equation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">+</span> <span class="n">by</span> <span class="o">+</span> <span class="n">cz</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span>
</pre></div>
</div>
<p>This method returns the <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code> and <code class="docutils literal notranslate"><span class="pre">d</span></code>
coefficients of this equation for the plane formed by the
bonder centroids. The coefficents <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> and <code class="docutils literal notranslate"><span class="pre">c</span></code>
describe the normal vector to the plane. The coefficent <code class="docutils literal notranslate"><span class="pre">d</span></code>
is found by substituting these coefficients along with the
x, y and z variables in the scalar equation and
solving for <code class="docutils literal notranslate"><span class="pre">d</span></code>. The variables x, y and z are
substituted by the coordinates of some point on the plane. For
example, the position of one of the bonder centroids.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">This array has the form <code class="docutils literal notranslate"><span class="pre">[a,</span> <span class="pre">b,</span> <span class="pre">c,</span> <span class="pre">d]</span></code> and represents the
scalar equation of the plane formed by the bonder
centroids.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://tinyurl.com/okpqv6">https://tinyurl.com/okpqv6</a></p>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.bonder_plane_normal">
<code class="descname">bonder_plane_normal</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.bonder_plane_normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the normal to the plane formed by bonder centroids.</p>
<p>The normal of the plane is defined such that it goes in the
direction toward the centroid of the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A unit vector which describes the normal to the plane of
the bonder centroids.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.bonder_position_matrix">
<code class="descname">bonder_position_matrix</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.bonder_position_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a matrix holding the positions of bonder centroids.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The array has the shape <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">n]</span></code>. Each column holds the
x, y and z coordinates of a bonder centroid. The index of
the column corresponds to the id of the functional group.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.cache">
<code class="descname">cache</code><em class="property"> = {}</em><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.center_of_mass">
<code class="descname">center_of_mass</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.center_of_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the centre of mass of the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An array holding the coordinates of the center of mass.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Center_of_mass">https://en.wikipedia.org/wiki/Center_of_mass</a></p>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.centroid">
<code class="descname">centroid</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the centroid of the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A numpy array holding the position of the centroid.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.centroid_centroid_dir_vector">
<code class="descname">centroid_centroid_dir_vector</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.centroid_centroid_dir_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the direction vector between the 2 molecular centroids.</p>
<p>The first molecular centroid is the centroid of the entire
molecule. The second molecular centroid is given by
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit3.bonder_centroid" title="stk.molecular.molecules.struct_unit.StructUnit3.bonder_centroid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bonder_centroid()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The normalized direction vector running from the centroid
of the bonder atoms to the molecular centroid.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.core">
<code class="descname">core</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.core" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the molecule with no H or functional group atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The “core” of the molecule.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.dihedral_strain">
<code class="descname">dihedral_strain</code><span class="sig-paren">(</span><em>dihedral_SMARTS=''</em>, <em>target=180</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.dihedral_strain" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the difference between the average dihedral and target.</p>
<p>The differences is a returned as a percent.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dihedral_SMARTS</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The SMARTS code for the dihedral of interest.</li>
<li><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Float representing the target value for the dihedral angle.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The percent difference between the average dihedral in the
molecule and the target value.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.direction">
<code class="descname">direction</code><span class="sig-paren">(</span><em>exclude_ids=None</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.direction" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the direction of the molecule or its atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>excluded_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of atoms exluded from the direction calculation.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Direction vector of the molecule (excluding <cite>exclude_ids</cite>).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.dump">
<code class="descname">dump</code><span class="sig-paren">(</span><em>path</em>, <em>include_attrs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a JSON <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> of the molecule to a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file to which the JSON dict should be
written.</li>
<li><strong>include_attrs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of attributes of the molecule to be added to
the JSON. Each attribute is saved as a string using
<code class="xref py py-func docutils literal notranslate"><span class="pre">repr()</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.fg_bonder_centroid">
<code class="descname">fg_bonder_centroid</code><span class="sig-paren">(</span><em>fg_id</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.fg_bonder_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>The centroid of bonder atoms in a functional group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fg_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the functional group.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The coordinates of a bonder centroid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.fg_distance">
<code class="descname">fg_distance</code><span class="sig-paren">(</span><em>fg1</em>, <em>fg2</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.fg_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>The distance between the bonder centroids of two fgs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fg1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The <code class="docutils literal notranslate"><span class="pre">fg_id</span></code> of the first fg.</li>
<li><strong>fg2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The <code class="docutils literal notranslate"><span class="pre">fg_id</span></code> of the second fg.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The distance between <cite>fg1</cite> and <cite>fg2</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.from_dict">
<em class="property">classmethod </em><code class="descname">from_dict</code><span class="sig-paren">(</span><em>json_dict</em>, <em>load_names=True</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> from a JSON <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> returned has the class specified in
<cite>json_dict</cite>, not <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>json_dict</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – A <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> holding the JSON representation of a
molecule.</li>
<li><strong>load_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> then the <code class="docutils literal notranslate"><span class="pre">name</span></code> key stored in <cite>json_dict</cite>
is loaded.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The molecule represented by <cite>json_dict</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.functional_groups">
<code class="descname">functional_groups</code><span class="sig-paren">(</span><em>fg_names</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.functional_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds given functional groups in the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fg_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The names of functional groups which are to be found
within the molecule.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> holding a <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup`</span></code>
instance for every matched functional group in the
molecule.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.gen_key">
<em class="property">static </em><code class="descname">gen_key</code><span class="sig-paren">(</span><em>rdkit_mol</em>, <em>functional_groups</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.gen_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the key used when caching the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rdkit_mol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code>) – An <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> instance of the molecule.</li>
<li><strong>functional_groups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The name of the functional groups being used to make
macromolecules.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>The key used for caching the molecule. Has the form</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s1">&#39;amine&#39;</span><span class="p">,</span> <span class="s1">&#39;bromine&#39;</span><span class="p">,</span> <span class="s1">&#39;InChIString&#39;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.graph">
<code class="descname">graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a mathematical graph representing the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A graph where the nodes are the ids of the atoms and the
edges are the bonds.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">networkx.Graph</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.inchi">
<code class="descname">inchi</code><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.inchi" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the InChI of the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The InChI of the molecule.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.init_funcs">
<code class="descname">init_funcs</code><em class="property"> = {'.mae': &lt;function mol_from_mae_file&gt;, '.mol': functools.partial(&lt;Boost.Python.function object&gt;, sanitize=False, removeHs=False), '.mol2': functools.partial(&lt;Boost.Python.function object&gt;, sanitize=False, removeHs=False), '.pdb': functools.partial(&lt;Boost.Python.function object&gt;, sanitize=False, removeHs=False), '.sdf': functools.partial(&lt;Boost.Python.function object&gt;, sanitize=False, removeHs=False)}</em><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.init_funcs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.init_random">
<em class="property">classmethod </em><code class="descname">init_random</code><span class="sig-paren">(</span><em>db</em>, <em>functional_groups=None</em>, <em>name=''</em>, <em>note=''</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.init_random" title="Permalink to this definition">¶</a></dt>
<dd><p>Picks a random file from <cite>db</cite> to initialize from.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>db</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – A path to a database of molecular files.</li>
<li><strong>functional_groups</strong> (:class`list` of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The name of a functional groups which the molecules in <cite>db</cite>
have. By default it is assumed the name is present in the
path of the files.</li>
<li><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The name to be given to the created molecule.</li>
<li><strong>note</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – A note to be given to the created molecule.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A random molecule from <cite>db</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code> – If no files in <cite>db</cite> could be initialized from.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.is_core_atom">
<code class="descname">is_core_atom</code><span class="sig-paren">(</span><em>atom_id</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.is_core_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if atom is not H or part of a fg.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the atom being queried.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Indicates whether the atom with <cite>atom_id</cite> is part of the
core.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.json">
<code class="descname">json</code><span class="sig-paren">(</span><em>include_attrs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.json" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a JSON representation of the molecule.</p>
<p>The representation has the following form:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;class&#39;</span> <span class="p">:</span> <span class="s1">&#39;StructUnit&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mol_block&#39;</span> <span class="p">:</span> <span class="s1">&#39;&#39;&#39;A string holding the V3000 mol</span>
<span class="s1">                     block of the molecule.&#39;&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;note&#39;</span> <span class="p">:</span> <span class="s1">&#39;This molecule is nice.&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;benzene&#39;</span><span class="p">,</span>
    <span class="s1">&#39;atom_props&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;prop1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                       <span class="s1">&#39;prop2&#39;</span><span class="p">:</span> <span class="s1">&#39;value1&#39;</span><span class="p">}}</span>
<span class="p">}</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>include_attrs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of attributes of the molecule to be added to
the JSON. Each attribute is saved as a string using
<code class="xref py py-func docutils literal notranslate"><span class="pre">repr()</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> which represents the molecule.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.load">
<em class="property">classmethod </em><code class="descname">load</code><span class="sig-paren">(</span><em>path</em>, <em>load_names=True</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> from a JSON file.</p>
<p>The returned <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> has the class specified in the
JSON file, not <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path holding a JSON representation to a molecule.</li>
<li><strong>load_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> then the <code class="docutils literal notranslate"><span class="pre">name</span></code> key stored in the JSON file
is loaded.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The molecule held in <cite>path</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.max_diameter">
<code class="descname">max_diameter</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.max_diameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the largest distance between 2 atoms in the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of the form<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">max_diameter</span> <span class="o">=</span> <span class="p">(</span><span class="mf">312.3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">54</span><span class="p">)</span>
</pre></div>
</div>
<p>Where the first element is the largest inter-atomic
distance in the molecule. The next 2 elements are the ids
of the involved atoms.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of form (float, int, int)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.mdl_mol_block">
<code class="descname">mdl_mol_block</code><span class="sig-paren">(</span><em>atoms=None</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.mdl_mol_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a V3000 mol block of the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The V3000 mol block representing the molecule.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.minimize_theta">
<code class="descname">minimize_theta</code><span class="sig-paren">(</span><em>v1</em>, <em>v2</em>, <em>axis</em>, <em>centroid</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.minimize_theta" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule to minimize angle between <cite>v1</cite> and <cite>v2</cite>.</p>
<p>The rotation is done about the vector <cite>axis</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>v1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector which is rotated.</li>
<li><strong>v2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector which is stationary.</li>
<li><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector about which the rotation happens.</li>
<li><strong>centroid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The position vector at the center of the rotation.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.minimize_theta2">
<code class="descname">minimize_theta2</code><span class="sig-paren">(</span><em>fg_id</em>, <em>vector</em>, <em>axis</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.minimize_theta2" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate molecule to minimize angle between <cite>fg_id</cite> and <cite>vector</cite>.</p>
<p>The rotation is done about <cite>axis</cite> and is centered on the
bonder centroid, as given by
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit.bonder_centroid" title="stk.molecular.molecules.struct_unit.StructUnit.bonder_centroid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bonder_centroid()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fg_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of functional group which is to have angle
minimized.</li>
<li><strong>vector</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A vector with which the angle is minimized.</li>
<li><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector about which the rotation happens.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.plane_normal">
<code class="descname">plane_normal</code><span class="sig-paren">(</span><em>atom_ids=None</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.plane_normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the best fit plane of the molecule or its atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The ids of the atoms that are assumed to be on the plane.
Only their coordinates will be used for fitting.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> then atoms forming the largest cycle are found
prior to fitting the plane.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Vector orthonormal to the plane of the molecule.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.position_matrix">
<code class="descname">position_matrix</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.position_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a matrix holding the atomic positions of a conformer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The array has the shape <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">n]</span></code>. Each column holds the
x, y and z coordinates of a bonder centroid. The index of
the column corresponds to the atom id.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>theta</em>, <em>axis</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule by <cite>theta</cite> about <cite>axis</cite>.</p>
<p>The rotation occurs about the molecular centroid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>theta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The size of the rotation in radians.</li>
<li><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The axis about which the rotation happens.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.rotate2">
<code class="descname">rotate2</code><span class="sig-paren">(</span><em>theta</em>, <em>axis</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.rotate2" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule by <cite>theta</cite> about <cite>axis</cite>.</p>
<p>The rotation occurs about the centroid of the bonder atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>theta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The size of the rotation in radians.</li>
<li><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The axis about which rotation happens.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.same">
<code class="descname">same</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.same" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <cite>other</cite> has the same molecular structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>) – The <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> instance you are checking has
the same structure.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the structures match.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.save_rdkit_atom_props">
<code class="descname">save_rdkit_atom_props</code><span class="sig-paren">(</span><em>prop_names</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.save_rdkit_atom_props" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates <a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule.atom_props" title="stk.molecular.molecules.molecule.Molecule.atom_props"><code class="xref py py-attr docutils literal notranslate"><span class="pre">atom_props</span></code></a> with rdkit atom tags.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>prop_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The names of atom properties which should be saved.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.set_bonder_centroid">
<code class="descname">set_bonder_centroid</code><span class="sig-paren">(</span><em>position</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.set_bonder_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Move the molecule so that the bonder centroid is on <cite>position</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>position</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – An array holding the desired the position. It holds
the x, y and z coordinates, respectively.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule after it has been shifted. The same
instance as in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.set_orientation">
<code class="descname">set_orientation</code><span class="sig-paren">(</span><em>start</em>, <em>end</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.set_orientation" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule by a rotation from <cite>start</cite> to <cite>end</cite>.</p>
<p>Given two direction vectors, <cite>start</cite> and <cite>end</cite>, this method
applies the rotation required transform <cite>start</cite> to <cite>end</cite> on
the molecule. The rotation occurs about the centroid of the
molecule.</p>
<p>For example, if the <cite>start</cite> and <cite>end</cite> vectors
are 45 degrees apart, a 45 degree rotation will be applied to
the molecule. The rotation will be along the appropriate
direction.</p>
<p>The great thing about this method is that you as long as you
can associate a geometric feature of the molecule with a
vector, then the molecule can be rotated so that this vector is
aligned with <cite>end</cite>. The defined vector can be virtually
anything. This means that any geometric feature of the molecule
can be easily aligned with any arbitrary axis.</p>
<p class="rubric">Notes</p>
<p>The difference between this method and
<a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit._set_orientation2" title="stk.molecular.molecules.struct_unit.StructUnit._set_orientation2"><code class="xref py py-meth docutils literal notranslate"><span class="pre">StructUnit._set_orientation2()</span></code></a> is about which point the
rotation occurs: centroid of the entire molecule versus
centroid of the bonder atoms, respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A vector which is to be rotated so that it transforms to
the <cite>end</cite> vector.</li>
<li><strong>end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – This array holds the vector, onto which <cite>start</cite> is rotated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.set_orientation2">
<code class="descname">set_orientation2</code><span class="sig-paren">(</span><em>end</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.set_orientation2" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule so the plane normal is aligned with <cite>end</cite>.</p>
<p>Here “plane normal” referes to the normal of the plane formed
by the bonder centroids. The molecule is rotated about
<code class="xref py py-meth docutils literal notranslate"><span class="pre">bonder_centroid()</span></code>. The rotation results in the
normal of the plane being aligned with <cite>end</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector with which the normal of plane of bonder
centroids shoould be aligned.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.set_position">
<code class="descname">set_position</code><span class="sig-paren">(</span><em>position</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.set_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the centroid of the molecule to <cite>position</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>position</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – This array holds the position on which the centroid of the
molecule should be placed.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule with the centroid placed at
<cite>position</cite>. This is the same instance as that in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Molecule.mol</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.set_position_from_matrix">
<code class="descname">set_position_from_matrix</code><span class="sig-paren">(</span><em>pos_mat</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.set_position_from_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Set atomic positions of the molecule to those in <cite>pos_mat</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pos_mat</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – <p>The matrix holds the coordinates on which the atoms of the
molecule should be placed.</p>
<p>The shape of the matrix is <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">n]</span></code>. Each column of
<cite>pos_mat</cite> represents the coordinates of a single atom. The
1st column sets the coordinates of the atom with id of 0.
The next column sets the coordinates of the atom with id 1,
and so on.</p>
</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.shift">
<code class="descname">shift</code><span class="sig-paren">(</span><em>shift</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Shifts the coordinates of all atoms.</p>
<p>This does not modify the molecule. A modified copy is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>shift</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A numpy array holding the value of the shift along each
axis.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A copy of the molecule where the coordinates have been
shifted by <cite>shift</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.shift_fgs">
<code class="descname">shift_fgs</code><span class="sig-paren">(</span><em>new_ids</em>, <em>shift</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.shift_fgs" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield new functional groups with atomic ids shifted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>new_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids assigned to the new functional groups.</li>
<li><strong>num_atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number to shift each atom id by.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last"><a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a> – A functional group from <a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit.func_groups" title="stk.molecular.molecules.struct_unit.StructUnit.func_groups"><code class="xref py py-attr docutils literal notranslate"><span class="pre">func_groups</span></code></a>
with atomic ids shifted by <cite>shift</cite>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.similar_molecules">
<code class="descname">similar_molecules</code><span class="sig-paren">(</span><em>mols</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.similar_molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns molecules from <cite>mols</cite> ordered by similarity.</p>
<p>The most similar molecule is at index 0.</p>
<p>This method uses the Morgan fingerprints of radius 4 to
evaluate how similar the molecules in <cite>mols</cite> are.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mols</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code>) – A group of molecules to which similarity is compared.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of the form,<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">returned_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">8.9</span><span class="p">,</span> <span class="n">mol1</span><span class="p">),</span> <span class="p">(</span><span class="mf">7.3</span><span class="p">,</span> <span class="n">mol2</span><span class="p">),</span> <span class="p">(</span><span class="mf">3.4</span><span class="p">,</span> <span class="n">mol3</span><span class="p">)]</span>
</pre></div>
</div>
<p>where the <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code> is the similarity of a given
molecule in <cite>mols</cite> while the <code class="docutils literal notranslate"><span class="pre">`mol</span></code> is corresponding
<code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule. Most similar molecule yielded first.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.smiles_init">
<em class="property">classmethod </em><code class="descname">smiles_init</code><span class="sig-paren">(</span><em>smiles</em>, <em>functional_groups=None</em>, <em>random_seed=4</em>, <em>note=''</em>, <em>name=''</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.smiles_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize from a SMILES string.</p>
<p>The structure of the molecule is embedded using
<code class="xref py py-func docutils literal notranslate"><span class="pre">rdkit.ETKDG()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>smiles</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – A SMILES string of the molecule.</li>
<li><strong>functional_groups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The name of the functional groups which are to have atoms
tagged. If no functional groups are provided to this
parameter, no tagging is done.</li>
<li><strong>random_seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – Random seed passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">rdkit.ETKDG()</span></code></li>
<li><strong>note</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – A note or comment about the molecule.</li>
<li><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – A name which can be optionally given to the molcule for
easy identification.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A <a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> instance of the molecule in <cite>smarts</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.subclasses">
<code class="descname">subclasses</code><em class="property"> = {'Cage': &lt;class 'stk.molecular.molecules.cage.Cage'&gt;, 'CageComplex': &lt;class 'stk.molecular.molecules.cage.CageComplex'&gt;, 'CageStructUnit': &lt;class 'stk.molecular.molecules.cage.CageStructUnit'&gt;, 'MacroMolecule': &lt;class 'stk.molecular.molecules.macro_molecule.MacroMolecule'&gt;, 'Macrocycle': &lt;class 'stk.molecular.molecules.macrocycle.Macrocycle'&gt;, 'MacrocycleStructUnit': &lt;class 'stk.molecular.molecules.macrocycle.MacrocycleStructUnit'&gt;, 'Periodic': &lt;class 'stk.molecular.molecules.periodic.Periodic'&gt;, 'Polymer': &lt;class 'stk.molecular.molecules.polymer.Polymer'&gt;, 'Rotaxane': &lt;class 'stk.molecular.molecules.rotaxane.Rotaxane'&gt;, 'StructUnit': &lt;class 'stk.molecular.molecules.struct_unit.StructUnit'&gt;, 'StructUnit2': &lt;class 'stk.molecular.molecules.struct_unit.StructUnit2'&gt;, 'StructUnit3': &lt;class 'stk.molecular.molecules.struct_unit.StructUnit3'&gt;}</em><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.subclasses" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.update_cache">
<code class="descname">update_cache</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.update_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Update attributes of cached molecule.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code> returns modified copies of molecules.
In order to ensure that the cached molecules have
their attributes updated to the values of the copies, this
method must be run on the copies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.update_from_mae">
<code class="descname">update_from_mae</code><span class="sig-paren">(</span><em>path</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.update_from_mae" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates molecular structure to match an <code class="docutils literal notranslate"><span class="pre">.mae</span></code> file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path of the <code class="docutils literal notranslate"><span class="pre">.mae</span></code> file from which the structure
should be updated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to be updated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.update_from_mol">
<code class="descname">update_from_mol</code><span class="sig-paren">(</span><em>path</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.update_from_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates molecular structure to match an <code class="docutils literal notranslate"><span class="pre">.mol</span></code> file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path of the <code class="docutils literal notranslate"><span class="pre">.mol</span></code> file from which the structure
should be updated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to be updated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.update_from_xyz">
<code class="descname">update_from_xyz</code><span class="sig-paren">(</span><em>path</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.update_from_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates molecular structure to match a <code class="docutils literal notranslate"><span class="pre">.xyz</span></code> file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path of the <code class="docutils literal notranslate"><span class="pre">.mol</span></code> file from which the structure
should be updated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to be updated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code> – If the number of atoms in the file does not match the
number of atoms in the molecule or if atom elements in the
file do not agree with the atom elements in the molecule.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.update_stereochemistry">
<code class="descname">update_stereochemistry</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.update_stereochemistry" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates stereochemistry tags in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Molecule.mol</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.struct_unit.StructUnit3.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>path</em>, <em>atoms=None</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.struct_unit.StructUnit3.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a molecular structure file of the molecule.</p>
<p>This bypasses the need for writing functions in <code class="docutils literal notranslate"><span class="pre">rdkit</span></code>.
These have issues with macromolecules due to poor ring finding
and sanitization issues.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The <cite>path</cite> to which the molecule should be written.</li>
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Lukas Turcani

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>