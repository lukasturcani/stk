

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>stk.molecular.topologies.base module &mdash; stk  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> stk
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">stk.molecular.topologies.base module</a><ul>
<li><a class="reference internal" href="#extending-stk-adding-new-topologies">Extending stk: Adding new topologies.</a><ul>
<li><a class="reference internal" href="#general">General</a></li>
<li><a class="reference internal" href="#cages">Cages</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">stk</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>stk.molecular.topologies.base module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/stk.molecular.topologies.base.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-stk.molecular.topologies.base">
<span id="stk-molecular-topologies-base-module"></span><h1>stk.molecular.topologies.base module<a class="headerlink" href="#module-stk.molecular.topologies.base" title="Permalink to this headline">¶</a></h1>
<p>Defines the base <a class="reference internal" href="#stk.molecular.topologies.base.Topology" title="stk.molecular.topologies.base.Topology"><code class="xref py py-class docutils literal notranslate"><span class="pre">Topology</span></code></a> type.</p>
<div class="section" id="extending-stk-adding-new-topologies">
<span id="adding-topologies"></span><h2>Extending stk: Adding new topologies.<a class="headerlink" href="#extending-stk-adding-new-topologies" title="Permalink to this headline">¶</a></h2>
<div class="section" id="general">
<h3>General<a class="headerlink" href="#general" title="Permalink to this headline">¶</a></h3>
<p>A new topology class must be defined. The class must inherit
<a class="reference internal" href="#stk.molecular.topologies.base.Topology" title="stk.molecular.topologies.base.Topology"><code class="xref py py-class docutils literal notranslate"><span class="pre">Topology</span></code></a>. The new topology class will have to define
the methods <code class="xref py py-meth docutils literal notranslate"><span class="pre">place_mols()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">bonded_fgs()</span></code>. A description
of what these methods should do is given by <a class="reference internal" href="#stk.molecular.topologies.base.Topology.place_mols" title="stk.molecular.topologies.base.Topology.place_mols"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Topology.place_mols()</span></code></a>
and <a class="reference internal" href="#stk.molecular.topologies.base.Topology.bonded_fgs" title="stk.molecular.topologies.base.Topology.bonded_fgs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Topology.bonded_fgs()</span></code></a>.</p>
<p>The new class may optionally define the methods <code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare()</span></code> and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">cleanup()</span></code>. The former performs operations on the molecule
before it is joined up and has atoms deleted via
<a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.Reactor.react" title="stk.molecular.functional_groups.Reactor.react"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Reactor.react()</span></code></a>. The latter any final cleanup operations on the
assembled molecule. For example, converting the end functional groups
of a polymer into hydrogen atoms. See also <a class="reference internal" href="#stk.molecular.topologies.base.Topology.cleanup" title="stk.molecular.topologies.base.Topology.cleanup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Topology.cleanup()</span></code></a>.</p>
<p>During the build process, every time a building block is placed
in the macromolecule, new <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code> instances must be
made, which correspond to the functional groups added by virtue of
adding the building block. These must be added to the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Reactor</span></code> held in <a class="reference internal" href="#stk.molecular.topologies.base.Topology.reactor" title="stk.molecular.topologies.base.Topology.reactor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Topology.reactor</span></code></a>, specifically into
its <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.Reactor.func_groups" title="stk.molecular.functional_groups.Reactor.func_groups"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Reactor.func_groups</span></code></a> attribute. This means that the
reactor will keep the atom ids in these functional groups up to date
when it deletes atoms. However, note that any functional groups
yielded by <a class="reference internal" href="#stk.molecular.topologies.base.Topology.bonded_fgs" title="stk.molecular.topologies.base.Topology.bonded_fgs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Topology.bonded_fgs()</span></code></a> are automatically added, so
they do not have to be managed manually. If you do not wish to
automatically add the functional groups into
<a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.Reactor.func_groups" title="stk.molecular.functional_groups.Reactor.func_groups"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Reactor.func_groups</span></code></a> you can toggle it in
<a class="reference internal" href="#stk.molecular.topologies.base.Topology.track_fgs" title="stk.molecular.topologies.base.Topology.track_fgs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Topology.track_fgs</span></code></a>.</p>
</div>
<div class="section" id="cages">
<h3>Cages<a class="headerlink" href="#cages" title="Permalink to this headline">¶</a></h3>
<p>To add a new cage topology a new class should be created, named
after the topology. This class should inherit <a class="reference internal" href="stk.molecular.topologies.cage.base.html#stk.molecular.topologies.cage.base.CageTopology" title="stk.molecular.topologies.cage.base.CageTopology"><code class="xref py py-class docutils literal notranslate"><span class="pre">CageTopology</span></code></a>.
This will give access to various methods which are necessary
for dealing with any cage molecule. See the documenation of
<a class="reference internal" href="stk.molecular.topologies.cage.base.html#stk.molecular.topologies.cage.base.CageTopology" title="stk.molecular.topologies.cage.base.CageTopology"><code class="xref py py-class docutils literal notranslate"><span class="pre">CageTopology</span></code></a> for more details.</p>
<p>The new class will only need to have five class attributes added:</p>
<blockquote>
<div><ol class="arabic simple">
<li>a <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> called <code class="xref py py-attr docutils literal notranslate"><span class="pre">vertices</span></code></li>
<li>a <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> called <code class="xref py py-attr docutils literal notranslate"><span class="pre">edges</span></code></li>
<li><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_windows</span></code>, which holds the number of windows the cage
topology has.</li>
<li><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_window_types</span></code>, which holds the number of different
window types. For example, if <code class="xref py py-attr docutils literal notranslate"><span class="pre">n_window_types</span></code> is <code class="docutils literal notranslate"><span class="pre">2</span></code>,
then the topology will have two kinds of windows, each with a
different expected size. Windows of the same type are expected
to be of the same size.</li>
</ol>
</div></blockquote>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">vertices</span></code> holds instances of <a class="reference internal" href="stk.molecular.topologies.cage.base.html#stk.molecular.topologies.cage.base.Vertex" title="stk.molecular.topologies.cage.base.Vertex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code></a>. Each
instance represents a vertex of a cage and needs to be initialized
with the coordinates of that vertex. Vertices of a cage are where
building blocks of cages are placed.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">edges</span></code> holds instances of the <a class="reference internal" href="stk.molecular.topologies.cage.base.html#stk.molecular.topologies.cage.base.Edge" title="stk.molecular.topologies.cage.base.Edge"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edge</span></code></a>. Each
instance represents an edge of a cage and needs to be initialized
with two instances of <a class="reference internal" href="stk.molecular.topologies.cage.base.html#stk.molecular.topologies.cage.base.Vertex" title="stk.molecular.topologies.cage.base.Vertex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code></a>. The
<a class="reference internal" href="stk.molecular.topologies.cage.base.html#stk.molecular.topologies.cage.base.Vertex" title="stk.molecular.topologies.cage.base.Vertex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code></a> instances
should be held in <code class="xref py py-attr docutils literal notranslate"><span class="pre">vertices</span></code>, as mentioned above. The two
vertices are the ones which the edge connects. Linkers of cages are
placed on edges. The edge instances automatically derive their
positions from the vertices supplied during initialization.</p>
<p>The vertices need to be positioned such that the center of the
topology is at the origin.</p>
<dl class="class">
<dt id="stk.molecular.topologies.base.Topology">
<em class="property">class </em><code class="descclassname">stk.molecular.topologies.base.</code><code class="descname">Topology</code><span class="sig-paren">(</span><em>del_atoms=True</em>, <em>track_fgs=True</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.topologies.base.Topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Builds macromolecules.</p>
<p>More accurately, child classes of <a class="reference internal" href="#stk.molecular.topologies.base.Topology" title="stk.molecular.topologies.base.Topology"><code class="xref py py-class docutils literal notranslate"><span class="pre">Topology</span></code></a> take care of
building macromolecules.</p>
<p>This class directly defines any operations and attributes that are
needed by any topology during assembly. However, this class is not
used directly. It is intended to be inherited from. All
<a class="reference internal" href="stk.molecular.molecules.macro_molecule.html#stk.molecular.molecules.macro_molecule.MacroMolecule.topology" title="stk.molecular.molecules.macro_molecule.MacroMolecule.topology"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.topology</span></code></a> attributes hold an instance of a
<a class="reference internal" href="#stk.molecular.topologies.base.Topology" title="stk.molecular.topologies.base.Topology"><code class="xref py py-class docutils literal notranslate"><span class="pre">Topology</span></code></a> child class. Child classes of <a class="reference internal" href="#stk.molecular.topologies.base.Topology" title="stk.molecular.topologies.base.Topology"><code class="xref py py-class docutils literal notranslate"><span class="pre">Topology</span></code></a>
define operations specific to that one topology. For example, each
child class must define a <code class="xref py py-meth docutils literal notranslate"><span class="pre">join_mols()</span></code>, which creates bonds
between the building blocks of a macromolecule. The way in which
this is done will depend on what kind of macromolecules are being
built. In addition, each child class must define methods which
place the building blocks in approriate positions.</p>
<dl class="attribute">
<dt id="stk.molecular.topologies.base.Topology.del_atoms">
<code class="descname">del_atoms</code><a class="headerlink" href="#stk.molecular.topologies.base.Topology.del_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Toggles whether deleter atoms are deleted by
<a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.Reactor.result" title="stk.molecular.functional_groups.Reactor.result"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Reactor.result()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.topologies.base.Topology.reactor">
<code class="descname">reactor</code><a class="headerlink" href="#stk.molecular.topologies.base.Topology.reactor" title="Permalink to this definition">¶</a></dt>
<dd><p>The reactor which performs the reactions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.Reactor" title="stk.molecular.functional_groups.Reactor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reactor</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.topologies.base.Topology.track_fgs">
<code class="descname">track_fgs</code><a class="headerlink" href="#stk.molecular.topologies.base.Topology.track_fgs" title="Permalink to this definition">¶</a></dt>
<dd><p>Toggles whether functional groups yielded by
<a class="reference internal" href="#stk.molecular.topologies.base.Topology.bonded_fgs" title="stk.molecular.topologies.base.Topology.bonded_fgs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bonded_fgs()</span></code></a> are automatically added into
<a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.Reactor.func_groups" title="stk.molecular.functional_groups.Reactor.func_groups"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Reactor.func_groups</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.topologies.base.Topology.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>del_atoms=True</em>, <em>track_fgs=True</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.topologies.base.Topology.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.topologies.base.Topology.bonded_fgs">
<code class="descname">bonded_fgs</code><span class="sig-paren">(</span><em>macro_mol</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.topologies.base.Topology.bonded_fgs" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterator which yields functional groups to be bonded.</p>
<p>This iterator must yield <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple`s</span> <span class="pre">of</span>
<span class="pre">:class:</span></code>.FunctionalGroup` molecules. These are the functional
groups in the macromolecule which need to be bonded.</p>
<p>This <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> gets passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">Reactor.react()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>macro_mol</strong> (<a class="reference internal" href="stk.molecular.molecules.macro_molecule.html#stk.molecular.molecules.macro_molecule.MacroMolecule" title="stk.molecular.molecules.macro_molecule.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a>) – The molecule being assembled.</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NotImplementedError</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.topologies.base.Topology.build">
<code class="descname">build</code><span class="sig-paren">(</span><em>macro_mol</em>, <em>bb_conformers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.topologies.base.Topology.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Assembles <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> instances of macromolecules.</p>
<p>This method places an <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule of the assembled
macromolecule into the <a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule.mol" title="stk.molecular.molecules.molecule.Molecule.mol"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code></a> attribute of
<a class="reference internal" href="stk.molecular.molecules.macro_molecule.html#stk.molecular.molecules.macro_molecule.MacroMolecule" title="stk.molecular.molecules.macro_molecule.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a>. It also creates the
<a class="reference internal" href="stk.molecular.molecules.macro_molecule.html#stk.molecular.molecules.macro_molecule.MacroMolecule.bb_counter" title="stk.molecular.molecules.macro_molecule.MacroMolecule.bb_counter"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.bb_counter</span></code></a> and
<a class="reference internal" href="stk.molecular.molecules.macro_molecule.html#stk.molecular.molecules.macro_molecule.MacroMolecule.bonds_made" title="stk.molecular.molecules.macro_molecule.MacroMolecule.bonds_made"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.bonds_made</span></code></a> attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>macro_mol</strong> (<a class="reference internal" href="stk.molecular.molecules.macro_molecule.html#stk.molecular.molecules.macro_molecule.MacroMolecule" title="stk.molecular.molecules.macro_molecule.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a>) – The <a class="reference internal" href="stk.molecular.molecules.macro_molecule.html#stk.molecular.molecules.macro_molecule.MacroMolecule" title="stk.molecular.molecules.macro_molecule.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a> instance which needs to be
built.</li>
<li><strong>bb_conformers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The ids of the building block conformers to be used. Must
be equal in length to <cite>building_blocks</cite> and orders must
correspond. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then <code class="docutils literal notranslate"><span class="pre">-1</span></code> is used for all
building blocks.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.topologies.base.Topology.cleanup">
<code class="descname">cleanup</code><span class="sig-paren">(</span><em>macro_mol</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.topologies.base.Topology.cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs final clean up actions on an assembled molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>macro_mol</strong> (<a class="reference internal" href="stk.molecular.molecules.macro_molecule.html#stk.molecular.molecules.macro_molecule.MacroMolecule" title="stk.molecular.molecules.macro_molecule.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a>) – The molecule being assembled.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.topologies.base.Topology.place_mols">
<code class="descname">place_mols</code><span class="sig-paren">(</span><em>macro_mol</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.topologies.base.Topology.place_mols" title="Permalink to this definition">¶</a></dt>
<dd><p>Places building blocks.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecules of the building blocks are
combined into a single <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule and placed into
<cite>macro_mol.mol</cite>.</p>
<p>The function is also reponsible for updating
<a class="reference internal" href="stk.molecular.molecules.macro_molecule.html#stk.molecular.molecules.macro_molecule.MacroMolecule.bb_counter" title="stk.molecular.molecules.macro_molecule.MacroMolecule.bb_counter"><code class="xref py py-attr docutils literal notranslate"><span class="pre">bb_counter</span></code></a>.</p>
<p>This function must also add the tags <code class="docutils literal notranslate"><span class="pre">'bb_index'</span></code>
and <code class="docutils literal notranslate"><span class="pre">'mol_index'</span></code> to every atom in the molecule. The
<code class="docutils literal notranslate"><span class="pre">'bb_index'</span></code> tag identifies which building block the atom
belongs to. The building block is identified by its index
within <code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.building_blocks</span></code>.
The <code class="docutils literal notranslate"><span class="pre">'mol_index'</span></code> identifies which molecule of a specific
building the atom belongs to. For example, if
<code class="docutils literal notranslate"><span class="pre">bb_index</span> <span class="pre">=</span> <span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">mol_index</span> <span class="pre">=</span> <span class="pre">3</span></code> the atom belongs to
the 4th molecule of <code class="docutils literal notranslate"><span class="pre">macro_mol.building_blocks[1]</span></code> to
be added to the macromolecule. The utility function
<a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.add_fragment_props" title="stk.utilities.utilities.add_fragment_props"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_fragment_props()</span></code></a> is provided to help with this.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>macro_mol</strong> (<a class="reference internal" href="stk.molecular.molecules.macro_molecule.html#stk.molecular.molecules.macro_molecule.MacroMolecule" title="stk.molecular.molecules.macro_molecule.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a>) – The molecule being assembled.</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NotImplementedError</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.topologies.base.Topology.prepare">
<code class="descname">prepare</code><span class="sig-paren">(</span><em>macro_mol</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.topologies.base.Topology.prepare" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs ops between placing and reacting building blocks.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>macro_mol</strong> (<a class="reference internal" href="stk.molecular.molecules.macro_molecule.html#stk.molecular.molecules.macro_molecule.MacroMolecule" title="stk.molecular.molecules.macro_molecule.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a>) – The molecule being assembled.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="stk.molecular.topologies.base.TopologyMeta">
<em class="property">class </em><code class="descclassname">stk.molecular.topologies.base.</code><code class="descname">TopologyMeta</code><a class="headerlink" href="#stk.molecular.topologies.base.TopologyMeta" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code></p>
<p>Makes a repr of an instance, based initialization arguments used.</p>
<dl class="attribute">
<dt id="stk.molecular.topologies.base.TopologyMeta.__init__">
<code class="descname">__init__</code><a class="headerlink" href="#stk.molecular.topologies.base.TopologyMeta.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.topologies.base.TopologyMeta.mro">
<code class="descname">mro</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.topologies.base.TopologyMeta.mro" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a type’s method resolution order.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="stk.molecular.topologies.base.remove_confs">
<code class="descclassname">stk.molecular.topologies.base.</code><code class="descname">remove_confs</code><span class="sig-paren">(</span><em>building_blocks</em>, <em>keep</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.topologies.base.remove_confs" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes all conformers from <cite>building_blocks</cite> except <cite>keep</cite>.</p>
<p>All kept conformers have their id set to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>building_blocks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <a class="reference internal" href="stk.molecular.molecules.struct_unit.html#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a>) – A set of <a class="reference internal" href="stk.molecular.molecules.struct_unit.html#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> instances which represent the
building blocks forming a macromolecule.</li>
<li><strong>keep</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of the building block conformers to be used for
assembling the <a class="reference internal" href="stk.molecular.molecules.macro_molecule.html#stk.molecular.molecules.macro_molecule.MacroMolecule" title="stk.molecular.molecules.macro_molecule.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a>. Must be equal in length
to <cite>building_blocks</cite> and orders must correspond.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of the form,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">returned</span> <span class="o">=</span> <span class="p">[[</span><span class="n">conf1</span><span class="p">,</span> <span class="n">conf2</span><span class="p">,</span> <span class="n">conf3</span><span class="p">],</span>
            <span class="p">[</span><span class="n">conf4</span><span class="p">,</span> <span class="n">conf5</span><span class="p">],</span>
            <span class="p">[</span><span class="n">conf6</span><span class="p">,</span> <span class="n">conf7</span><span class="p">,</span> <span class="n">conf8</span><span class="p">,</span> <span class="n">conf9</span><span class="p">]]</span>
</pre></div>
</div>
<p>where each sublist holds all the original conformers of a
particular building block.</p>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Lukas Turcani

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>