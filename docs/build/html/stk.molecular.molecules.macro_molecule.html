

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>stk.molecular.molecules.macro_molecule module &mdash; stk  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> stk
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">stk.molecular.molecules.macro_molecule module</a><ul>
<li><a class="reference internal" href="#a-more-detailed-description-of-macromolecular-assembly">A more detailed description of macromolecular assembly.</a></li>
<li><a class="reference internal" href="#extending-stk-adding-new-macromolecules">Extending stk: Adding new macromolecules.</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">stk</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>stk.molecular.molecules.macro_molecule module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/stk.molecular.molecules.macro_molecule.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-stk.molecular.molecules.macro_molecule">
<span id="stk-molecular-molecules-macro-molecule-module"></span><h1>stk.molecular.molecules.macro_molecule module<a class="headerlink" href="#module-stk.molecular.molecules.macro_molecule" title="Permalink to this headline">¶</a></h1>
<p>Defines <a class="reference internal" href="#stk.molecular.molecules.macro_molecule.MacroMolecule" title="stk.molecular.molecules.macro_molecule.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a>.</p>
<p>The <a class="reference internal" href="#stk.molecular.molecules.macro_molecule.MacroMolecule" title="stk.molecular.molecules.macro_molecule.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a> class represents an assembled macromolecule.
It requires at least 2 basic pieces of information: which monomers are
used to assemble the macromolecule and what the topology/structure
of the macromolecule is.</p>
<p><a class="reference internal" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.building_blocks" title="stk.molecular.molecules.macro_molecule.MacroMolecule.building_blocks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.building_blocks</span></code></a> holds a <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of
<a class="reference internal" href="stk.molecular.molecules.struct_unit.html#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> instances. These represent the monomers which
make up the macromolecule. Only one <a class="reference internal" href="stk.molecular.molecules.struct_unit.html#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> instance per
monomer type is held. So if 4 of one type of monomer and 2 of another
type of monomer form a macromolecule, only 2 <a class="reference internal" href="stk.molecular.molecules.struct_unit.html#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a>
instances are in <a class="reference internal" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.building_blocks" title="stk.molecular.molecules.macro_molecule.MacroMolecule.building_blocks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.building_blocks</span></code></a>.</p>
<p><a class="reference internal" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.topology" title="stk.molecular.molecules.macro_molecule.MacroMolecule.topology"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.topology</span></code></a> holds a <a class="reference internal" href="stk.molecular.topologies.base.html#stk.molecular.topologies.base.Topology" title="stk.molecular.topologies.base.Topology"><code class="xref py py-class docutils literal notranslate"><span class="pre">Topology</span></code></a> instance.
This instance is responsible for assembling the macromolecule from the
building blocks. The building should happen in
<a class="reference internal" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.__init__" title="stk.molecular.molecules.macro_molecule.MacroMolecule.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MacroMolecule.__init__()</span></code></a> via <a class="reference internal" href="stk.molecular.topologies.base.html#stk.molecular.topologies.base.Topology.build" title="stk.molecular.topologies.base.Topology.build"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Topology.build()</span></code></a>. The
<a class="reference internal" href="stk.molecular.topologies.base.html#stk.molecular.topologies.base.Topology.build" title="stk.molecular.topologies.base.Topology.build"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build()</span></code></a> method places the assembled macromolecule in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.mol</span></code> as an <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule.</p>
<div class="section" id="a-more-detailed-description-of-macromolecular-assembly">
<span id="macromolecular-assembly"></span><h2>A more detailed description of macromolecular assembly.<a class="headerlink" href="#a-more-detailed-description-of-macromolecular-assembly" title="Permalink to this headline">¶</a></h2>
<p>This is a step-by-step guide of how macromolecular assembly is carried
out and what the classes do.</p>
<p>First you create <a class="reference internal" href="stk.molecular.molecules.struct_unit.html#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> instances of the building blocks
which make up the macromolecule:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bb</span> <span class="o">=</span> <span class="n">StructUnit</span><span class="p">(</span><span class="s1">&#39;/path/to/struct/file.mol2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;amine&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="stk.molecular.molecules.struct_unit.html#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> instances are initialized using paths to
molecular structure files. (Initializing a <a class="reference internal" href="stk.molecular.molecules.struct_unit.html#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a>
automatically completes steps 1 to 4.)</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">Place an <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> instance of the molecule into
<code class="xref py py-attr docutils literal notranslate"><span class="pre">StructUnit.mol</span></code>, i.e.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bb</span><span class="o">.</span><span class="n">mol</span>  <span class="c1"># &lt;rdkit.Chem.rdchem.Mol at 0x7f961a8f1f80&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Scan the path of the structure file for the names of functional
groups. (Alternatively the names of functional groups can be
supplied to the initializer). Find the <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FGInfo" title="stk.molecular.functional_groups.FGInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">FGInfo</span></code></a> instance
for each functional group.</p>
</li>
</ol>
</div></blockquote>
<p>Which functional groups are recognized by <code class="docutils literal notranslate"><span class="pre">stk</span></code>?</p>
<p>The module <a class="reference internal" href="stk.molecular.functional_groups.html#module-stk.molecular.functional_groups" title="stk.molecular.functional_groups"><code class="xref py py-mod docutils literal notranslate"><span class="pre">functional_groups</span></code></a> defines the class <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FGInfo" title="stk.molecular.functional_groups.FGInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">FGInfo</span></code></a>
and a <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of instances of this class called
<code class="xref py py-data docutils literal notranslate"><span class="pre">functional_groups</span></code>. If you put an <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FGInfo" title="stk.molecular.functional_groups.FGInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">FGInfo</span></code></a> instance into
<code class="xref py py-data docutils literal notranslate"><span class="pre">functional_groups</span></code>, the functional group will be recognized.</p>
<blockquote>
<div><ol class="arabic" start="3">
<li><p class="first">Using <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FGInfo" title="stk.molecular.functional_groups.FGInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">FGInfo</span></code></a> create <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a>
instances, which determine the bonder and deleter atoms in the
molecule. These identify which atoms form bonds during
macromolecular assembly and which ones are deleted. Place the
<a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a> instances into
<code class="xref py py-attr docutils literal notranslate"><span class="pre">StructUnit.func_groups</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bb</span><span class="o">.</span><span class="n">func_groups</span>
<span class="c1"># (FunctionalGroup(id=0,</span>
<span class="c1">#                  atom_ids=(45, 21, 0),</span>
<span class="c1">#                  bonder_ids=(21, ),</span>
<span class="c1">#                  deleter_ids=(0, 45),</span>
<span class="c1">#                  info=FGInfo(&#39;amine&#39;)),</span>
<span class="c1">#  FunctionalGroup(id=1,</span>
<span class="c1">#                  atom_ids=(47, 23, 15),</span>
<span class="c1">#                  bonder_ids=(47, ),</span>
<span class="c1">#                  deleter_ids=(23, 15),</span>
<span class="c1">#                  info=FGInfo(&#39;amine&#39;)))</span>
</pre></div>
</div>
</li>
</ol>
<ol class="arabic" start="5">
<li><p class="first">Give the <a class="reference internal" href="stk.molecular.molecules.struct_unit.html#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> and <a class="reference internal" href="stk.molecular.topologies.base.html#stk.molecular.topologies.base.Topology" title="stk.molecular.topologies.base.Topology"><code class="xref py py-class docutils literal notranslate"><span class="pre">Topology</span></code></a> instances
to the macromolecule’s initializer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">macro_mol</span> <span class="o">=</span> <span class="n">MacroMolecule</span><span class="p">([</span><span class="n">bb1</span><span class="p">,</span> <span class="n">bb2</span><span class="p">],</span> <span class="n">Topology</span><span class="p">())</span>
</pre></div>
</div>
<p>Normally, <a class="reference internal" href="#stk.molecular.molecules.macro_molecule.MacroMolecule" title="stk.molecular.molecules.macro_molecule.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a> and <a class="reference internal" href="stk.molecular.topologies.base.html#stk.molecular.topologies.base.Topology" title="stk.molecular.topologies.base.Topology"><code class="xref py py-class docutils literal notranslate"><span class="pre">Topology</span></code></a> will
not be used directly. Instead, classes derived from these
will be used. For example,</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">macro_mol</span> <span class="o">=</span> <span class="n">Polymer</span><span class="p">([</span><span class="n">bb1</span><span class="p">,</span> <span class="n">bb2</span><span class="p">],</span> <span class="n">Linear</span><span class="p">(</span><span class="s2">&quot;AB&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Run <a class="reference internal" href="stk.molecular.topologies.base.html#stk.molecular.topologies.base.Topology.build" title="stk.molecular.topologies.base.Topology.build"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Topology.build()</span></code></a> inside
<a class="reference internal" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.__init__" title="stk.molecular.molecules.macro_molecule.MacroMolecule.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MacroMolecule.__init__()</span></code></a>.</p>
</li>
<li><p class="first">The details of <a class="reference internal" href="stk.molecular.topologies.base.html#stk.molecular.topologies.base.Topology.build" title="stk.molecular.topologies.base.Topology.build"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Topology.build()</span></code></a> will vary depending on
the <a class="reference internal" href="stk.molecular.topologies.base.html#stk.molecular.topologies.base.Topology" title="stk.molecular.topologies.base.Topology"><code class="xref py py-class docutils literal notranslate"><span class="pre">Topology</span></code></a> class used. However, the basic structure
is the same (steps 8 - 10).</p>
</li>
<li><p class="first">Use <a class="reference internal" href="stk.molecular.topologies.base.html#stk.molecular.topologies.base.Topology.place_mols" title="stk.molecular.topologies.base.Topology.place_mols"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Topology.place_mols()</span></code></a> to combine the <code class="docutils literal notranslate"><span class="pre">rdkit</span></code>
molecules of all the building blocks into a single <code class="docutils literal notranslate"><span class="pre">rdkit</span></code>
instance. The combined <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> instance is placed into
<code class="docutils literal notranslate"><span class="pre">macro_mol.mol</span></code>. <a class="reference internal" href="stk.molecular.topologies.base.html#stk.molecular.topologies.base.Topology.place_mols" title="stk.molecular.topologies.base.Topology.place_mols"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Topology.place_mols()</span></code></a> also usually
keeps track of each functional group in the macromolecule.
If a buliding block is placed in a macromolecule, the atom
ids have to be shifted upward by some amount.
<a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup.shifted_fg" title="stk.molecular.functional_groups.FunctionalGroup.shifted_fg"><code class="xref py py-meth docutils literal notranslate"><span class="pre">FunctionalGroup.shifted_fg()</span></code></a> performs this operation.</p>
</li>
<li><p class="first">Use <a class="reference internal" href="stk.molecular.topologies.base.html#stk.molecular.topologies.base.Topology.prepare" title="stk.molecular.topologies.base.Topology.prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Topology.prepare()</span></code></a> to run any additional operations
before joining up the building blocks and deleting extra
atoms, this method may do nothing.</p>
</li>
<li><p class="first">Use <a class="reference internal" href="stk.molecular.topologies.base.html#stk.molecular.topologies.base.Topology.bonded_fgs" title="stk.molecular.topologies.base.Topology.bonded_fgs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Topology.bonded_fgs()</span></code></a> to yield the functional groups
which react. The <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup`s</span> <span class="pre">in</span> <span class="pre">the</span>
<span class="pre">macromolecule</span> <span class="pre">are</span> <span class="pre">passed</span> <span class="pre">to</span> <span class="pre">:meth:</span></code>.Reactor.react`, which
performs the reaction. See the documentation of
<code class="xref py py-class docutils literal notranslate"><span class="pre">Reactor</span></code> for information on how reactions are carried
out.</p>
</li>
<li><p class="first">Run <a class="reference internal" href="stk.molecular.topologies.base.html#stk.molecular.topologies.base.Topology.cleanup" title="stk.molecular.topologies.base.Topology.cleanup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Topology.cleanup()</span></code></a> to perform any final operations
on the assembled molecule. Can be nothing.</p>
</li>
</ol>
</div></blockquote>
<p>After all this you should have a <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> instance of the
macromolecule which should be placed into <code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.mol</span></code>.</p>
</div>
<div class="section" id="extending-stk-adding-new-macromolecules">
<span id="adding-macromolecules"></span><h2>Extending stk: Adding new macromolecules.<a class="headerlink" href="#extending-stk-adding-new-macromolecules" title="Permalink to this headline">¶</a></h2>
<p>To add new macromolecules create a new class which inherits
<a class="reference internal" href="#stk.molecular.molecules.macro_molecule.MacroMolecule" title="stk.molecular.molecules.macro_molecule.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a>.</p>
<p>If you’re adding a new class of macromolecules, it quite likely you
want to add a new <a class="reference internal" href="stk.molecular.topologies.base.html#stk.molecular.topologies.base.Topology" title="stk.molecular.topologies.base.Topology"><code class="xref py py-class docutils literal notranslate"><span class="pre">Topology</span></code></a> class. See the
<a class="reference internal" href="stk.molecular.topologies.base.html#module-stk.molecular.topologies.base" title="stk.molecular.topologies.base"><code class="xref py py-mod docutils literal notranslate"><span class="pre">topologies.base</span></code></a> for guidance on adding these. The topology
class does the assembly of the macromolecule from the building blocks.</p>
<dl class="class">
<dt id="stk.molecular.molecules.macro_molecule.Cached">
<em class="property">class </em><code class="descclassname">stk.molecular.molecules.macro_molecule.</code><code class="descname">Cached</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.Cached" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code></p>
<p>A metaclass for creating classes which create cached instances.</p>
<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.Cached.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.Cached.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.Cached.mro">
<code class="descname">mro</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.Cached.mro" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a type’s method resolution order.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule">
<em class="property">class </em><code class="descclassname">stk.molecular.molecules.macro_molecule.</code><code class="descname">MacroMolecule</code><span class="sig-paren">(</span><em>building_blocks</em>, <em>topology</em>, <em>name=''</em>, <em>note=''</em>, <em>bb_conformers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">stk.molecular.molecules.molecule.Molecule</span></code></a></p>
<p>A representing assembled macromolecules.</p>
<p>Because of the computational cost associated with macromolecule
assembly, instances of this class are cached. This means that
providing the same arguments to the initializer will not build a
different instance with the same attribute values. It will yield
the original instance, retrieved from memory.</p>
<p>This class is not intended to be used directly but should be
inherited by subclasses representing specific macromolecules. The
<code class="xref py py-class docutils literal notranslate"><span class="pre">Cage</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">Polymer</span></code> classes are examples of this.
Any information or methods that apply generally to all
macromolecule should be defined within this class while specific
non-general data should be included in the derived classes.</p>
<dl class="attribute">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.building_blocks">
<code class="descname">building_blocks</code><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.building_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>This attribute holds <a class="reference internal" href="stk.molecular.molecules.struct_unit.html#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> instances which
represent the monomers forming the macromolecule. Only one
<a class="reference internal" href="stk.molecular.molecules.struct_unit.html#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> instance is needed per building block,
even if multiples of that molecule join up to form the
macromolecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <a class="reference internal" href="stk.molecular.molecules.struct_unit.html#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.bb_counter">
<code class="descname">bb_counter</code><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.bb_counter" title="Permalink to this definition">¶</a></dt>
<dd><p>A counter keeping track of how much of each building block is
used to form the macromolecule. Added by
<code class="xref py py-func docutils literal notranslate"><span class="pre">Topology.build()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.Counter</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.topology">
<code class="descname">topology</code><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the shape of macromolecule and assembles it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="stk.molecular.topologies.base.html#stk.molecular.topologies.base.Topology" title="stk.molecular.topologies.base.Topology"><code class="xref py py-class docutils literal notranslate"><span class="pre">Topology</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.bonds_made">
<code class="descname">bonds_made</code><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.bonds_made" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of bonds made during assembly. Added by
<code class="xref py py-func docutils literal notranslate"><span class="pre">Topology.build()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.func_groups">
<code class="descname">func_groups</code><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.func_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>The remnants of building block functional groups present in the
molecule. These functional groups track which atoms belonged to
functional groups in the building block molecules. The id of
each <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a> should match its index.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>building_blocks</em>, <em>topology</em>, <em>name=''</em>, <em>note=''</em>, <em>bb_conformers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a <a class="reference internal" href="#stk.molecular.molecules.macro_molecule.MacroMolecule" title="stk.molecular.molecules.macro_molecule.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a> instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>building_blocks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <a class="reference internal" href="stk.molecular.molecules.struct_unit.html#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a>) – The <a class="reference internal" href="stk.molecular.molecules.struct_unit.html#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a> instances of building blocks
forming the macromolecule.</li>
<li><strong>topology</strong> (<a class="reference internal" href="stk.molecular.topologies.base.html#stk.molecular.topologies.base.Topology" title="stk.molecular.topologies.base.Topology"><code class="xref py py-class docutils literal notranslate"><span class="pre">Topology</span></code></a>) – Defines the shape of macromolecule and assembles it.</li>
<li><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – A name which can be given to the molcule for easy
identification.</li>
<li><strong>note</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – A note or comment about the molecule.</li>
<li><strong>bb_conformers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The ids of the building block conformers to be used. Must
be equal in length to <cite>building_blocks</cite> and orders must
correspond. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then <code class="docutils literal notranslate"><span class="pre">-1</span></code> is used for all
building blocks.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule._json_init">
<em class="property">classmethod </em><code class="descname">_json_init</code><span class="sig-paren">(</span><em>json_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule._json_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Completes a JSON initialization.</p>
<p>This function is not to be used. Use <code class="xref py py-meth docutils literal notranslate"><span class="pre">Molecule.load()</span></code>
for loading instances from a JSON string. That function will
automatically call this one.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>json_dict</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – A dictionary holding the attribute data of the molecule.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule._write_mdl_mol_file">
<code class="descname">_write_mdl_mol_file</code><span class="sig-paren">(</span><em>path</em>, <em>atoms</em>, <em>conformer</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule._write_mdl_mol_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a V3000 <code class="docutils literal notranslate"><span class="pre">.mol</span></code> file of the molecule</p>
<p>This function should not be used directly, only via
<a class="reference internal" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.write" title="stk.molecular.molecules.macro_molecule.MacroMolecule.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file being written.</li>
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule._write_pdb_file">
<code class="descname">_write_pdb_file</code><span class="sig-paren">(</span><em>path</em>, <em>atoms</em>, <em>conformer</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule._write_pdb_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <code class="docutils literal notranslate"><span class="pre">.pdb</span></code> file of the molecule</p>
<p>This function should not be used directly, only via
<a class="reference internal" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.write" title="stk.molecular.molecules.macro_molecule.MacroMolecule.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file being written.</li>
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule._write_xyz_file">
<code class="descname">_write_xyz_file</code><span class="sig-paren">(</span><em>path</em>, <em>atoms</em>, <em>conformer</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule._write_xyz_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <code class="docutils literal notranslate"><span class="pre">.xyz</span></code> file of the molecule</p>
<p>This function should not be used directly, only via
<a class="reference internal" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.write" title="stk.molecular.molecules.macro_molecule.MacroMolecule.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file being written.</li>
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.add_conformer">
<code class="descname">add_conformer</code><span class="sig-paren">(</span><em>bb_conformers</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.add_conformer" title="Permalink to this definition">¶</a></dt>
<dd><p>Assembles a new conformer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>bb_conformers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of the building block conformers to be used. Must
be equal in length to <a class="reference internal" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.building_blocks" title="stk.molecular.molecules.macro_molecule.MacroMolecule.building_blocks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">building_blocks</span></code></a> and orders
must correspond. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then <code class="docutils literal notranslate"><span class="pre">-1</span></code> is used for all
building blocks.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The id of the new conformer.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.all_atom_coords">
<code class="descname">all_atom_coords</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.all_atom_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields the coordinates of atoms in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> – The yielded <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> has the form</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
</pre></div>
</div>
<p class="last">Where the first element is the atom id and the second
element is an array holding the coordinates of the atom.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.atom_centroid">
<code class="descname">atom_centroid</code><span class="sig-paren">(</span><em>atom_ids</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.atom_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the centroid of a group of atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of atoms which which are used to calculate the
centroid.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The centroid of atoms specified by <cite>atom_ids</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.atom_coords">
<code class="descname">atom_coords</code><span class="sig-paren">(</span><em>atom_id</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.atom_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Return coordinates of an atom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the atom whose coordinates are desired.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An array holding the x, y and z coordinates of the atom.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.atom_distance">
<code class="descname">atom_distance</code><span class="sig-paren">(</span><em>atom1_id</em>, <em>atom2_id</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.atom_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the distance between 2 atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom1_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the first atom.</li>
<li><strong>atom2_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the second atom.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The distance between the first and second atoms.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.double</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.atom_symbol">
<code class="descname">atom_symbol</code><span class="sig-paren">(</span><em>atom_id</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.atom_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the symbol of the atom with id <cite>atom_id</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id number of the atom.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The atomic symbol of the atom.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.bb_distortion">
<code class="descname">bb_distortion</code><span class="sig-paren">(</span><em>bb_conformers=None</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.bb_distortion" title="Permalink to this definition">¶</a></dt>
<dd><p>Rmsd difference of building blocks before and after assembly.</p>
<p>The function looks at each building block in the macromolecule
and calculates the rmsd between the “free” version and the one
present in the macromolecule. The mean of these rmsds is
returned.</p>
<p>Atoms which form the functional group of the building blocks
and hydrogens are excluded from the calculation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bb_conformers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of building block conformers to use. 1 id for each
building block, in an order corresponding to
<a class="reference internal" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.building_blocks" title="stk.molecular.molecules.macro_molecule.MacroMolecule.building_blocks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">building_blocks</span></code></a>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, all conformer ids
default to <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The mean rmsd of the macromole’s building blocks to their
“free” counterparts.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.building_block_cores">
<code class="descname">building_block_cores</code><span class="sig-paren">(</span><em>bb</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.building_block_cores" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields the “cores” of the building block molecules.</p>
<p>The structure of the yielded cores has the geometry found in
the macromolecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>bb</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The index of a building block molecule within
<a class="reference internal" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.building_blocks" title="stk.molecular.molecules.macro_molecule.MacroMolecule.building_blocks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">building_blocks</span></code></a>. The cores of this molecule are
yielded.</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code> – The core of a building block molecule, as found in the
macromolecule.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.cache">
<code class="descname">cache</code><em class="property"> = {}</em><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.center_of_mass">
<code class="descname">center_of_mass</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.center_of_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the centre of mass of the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An array holding the coordinates of the center of mass.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Center_of_mass">https://en.wikipedia.org/wiki/Center_of_mass</a></p>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.centroid">
<code class="descname">centroid</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the centroid of the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A numpy array holding the position of the centroid.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.core">
<code class="descname">core</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.core" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the molecule with no H or functional group atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The “core” of the molecule.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.dihedral_strain">
<code class="descname">dihedral_strain</code><span class="sig-paren">(</span><em>dihedral_SMARTS=''</em>, <em>target=180</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.dihedral_strain" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the difference between the average dihedral and target.</p>
<p>The differences is a returned as a percent.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dihedral_SMARTS</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The SMARTS code for the dihedral of interest.</li>
<li><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Float representing the target value for the dihedral angle.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The percent difference between the average dihedral in the
molecule and the target value.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.direction">
<code class="descname">direction</code><span class="sig-paren">(</span><em>exclude_ids=None</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.direction" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the direction of the molecule or its atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>excluded_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of atoms exluded from the direction calculation.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Direction vector of the molecule (excluding <cite>exclude_ids</cite>).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.dump">
<code class="descname">dump</code><span class="sig-paren">(</span><em>path</em>, <em>include_attrs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a JSON <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> of the molecule to a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file to which the JSON dict should be
written.</li>
<li><strong>include_attrs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of attributes of the molecule to be added to
the JSON. Each attribute is saved as a string using
<code class="xref py py-func docutils literal notranslate"><span class="pre">repr()</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.from_dict">
<em class="property">classmethod </em><code class="descname">from_dict</code><span class="sig-paren">(</span><em>json_dict</em>, <em>load_names=True</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> from a JSON <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> returned has the class specified in
<cite>json_dict</cite>, not <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>json_dict</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – A <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> holding the JSON representation of a
molecule.</li>
<li><strong>load_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> then the <code class="docutils literal notranslate"><span class="pre">name</span></code> key stored in <cite>json_dict</cite>
is loaded.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The molecule represented by <cite>json_dict</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.gen_key">
<em class="property">static </em><code class="descname">gen_key</code><span class="sig-paren">(</span><em>building_blocks</em>, <em>topology</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.gen_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the key used for caching the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>building_blocks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <a class="reference internal" href="stk.molecular.molecules.struct_unit.html#stk.molecular.molecules.struct_unit.StructUnit" title="stk.molecular.molecules.struct_unit.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a>) – The building blocks used to make the macromolecule.</li>
<li><strong>topology</strong> (<a class="reference internal" href="stk.molecular.topologies.base.html#stk.molecular.topologies.base.Topology" title="stk.molecular.topologies.base.Topology"><code class="xref py py-class docutils literal notranslate"><span class="pre">Topology</span></code></a>) – The topology used to make the macromolecule.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The key used for caching the macromolecule.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.graph">
<code class="descname">graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a mathematical graph representing the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A graph where the nodes are the ids of the atoms and the
edges are the bonds.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">networkx.Graph</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.inchi">
<code class="descname">inchi</code><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.inchi" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the InChI of the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The InChI of the molecule.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.is_core_atom">
<code class="descname">is_core_atom</code><span class="sig-paren">(</span><em>atom_id</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.is_core_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if atom is not H or part of a fg.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the atom being queried.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Indicates whether the atom with <cite>atom_id</cite> is part of the
core.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.json">
<code class="descname">json</code><span class="sig-paren">(</span><em>include_attrs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.json" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a JSON representation of the molecule.</p>
<p>The representation has the form</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;class&#39;</span> <span class="p">:</span> <span class="s1">&#39;Polymer&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mol_block&#39;</span> <span class="p">:</span> <span class="s1">&#39;&#39;&#39;A string holding the V3000 mol</span>
<span class="s1">                     block of the molecule.&#39;&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;building_blocks&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="n">bb1</span><span class="o">.</span><span class="n">json</span><span class="p">(),</span> <span class="n">bb2</span><span class="o">.</span><span class="n">json</span><span class="p">()},</span>
    <span class="s1">&#39;topology&#39;</span> <span class="p">:</span> <span class="s1">&#39;Copolymer(repeating_unit=&quot;AB&quot;)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;note&#39;</span> <span class="p">:</span> <span class="s1">&#39;A nice molecule.&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Poly-Benzene&#39;</span><span class="p">,</span>
    <span class="s1">&#39;atom_props&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;prop1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                       <span class="s1">&#39;prop2&#39;</span><span class="p">:</span> <span class="s1">&#39;value1&#39;</span><span class="p">}}</span>
<span class="p">}</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>include_attrs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of attributes of the molecule to be added to
the JSON. Each attribute is saved as a string using
<code class="xref py py-func docutils literal notranslate"><span class="pre">repr()</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> which represents the molecule.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.load">
<em class="property">classmethod </em><code class="descname">load</code><span class="sig-paren">(</span><em>path</em>, <em>load_names=True</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> from a JSON file.</p>
<p>The returned <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> has the class specified in the
JSON file, not <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path holding a JSON representation to a molecule.</li>
<li><strong>load_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> then the <code class="docutils literal notranslate"><span class="pre">name</span></code> key stored in the JSON file
is loaded.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The molecule held in <cite>path</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.max_diameter">
<code class="descname">max_diameter</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.max_diameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the largest distance between 2 atoms in the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of the form<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">max_diameter</span> <span class="o">=</span> <span class="p">(</span><span class="mf">312.3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">54</span><span class="p">)</span>
</pre></div>
</div>
<p>Where the first element is the largest inter-atomic
distance in the molecule. The next 2 elements are the ids
of the involved atoms.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of form (float, int, int)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.mdl_mol_block">
<code class="descname">mdl_mol_block</code><span class="sig-paren">(</span><em>atoms=None</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.mdl_mol_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a V3000 mol block of the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The V3000 mol block representing the molecule.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.plane_normal">
<code class="descname">plane_normal</code><span class="sig-paren">(</span><em>atom_ids=None</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.plane_normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the best fit plane of the molecule or its atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The ids of the atoms that are assumed to be on the plane.
Only their coordinates will be used for fitting.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> then atoms forming the largest cycle are found
prior to fitting the plane.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Vector orthonormal to the plane of the molecule.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.position_matrix">
<code class="descname">position_matrix</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.position_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a matrix holding the atomic positions of a conformer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The array has the shape <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">n]</span></code>. Each column holds the
x, y and z coordinates of a bonder centroid. The index of
the column corresponds to the atom id.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>theta</em>, <em>axis</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule by <cite>theta</cite> about <cite>axis</cite>.</p>
<p>The rotation occurs about the molecular centroid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>theta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The size of the rotation in radians.</li>
<li><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The axis about which the rotation happens.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.same">
<code class="descname">same</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.same" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <cite>other</cite> has the same molecular structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>) – The <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> instance you are checking has
the same structure.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the structures match.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.save_rdkit_atom_props">
<code class="descname">save_rdkit_atom_props</code><span class="sig-paren">(</span><em>prop_names</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.save_rdkit_atom_props" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates <a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule.atom_props" title="stk.molecular.molecules.molecule.Molecule.atom_props"><code class="xref py py-attr docutils literal notranslate"><span class="pre">atom_props</span></code></a> with rdkit atom tags.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>prop_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The names of atom properties which should be saved.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.set_orientation">
<code class="descname">set_orientation</code><span class="sig-paren">(</span><em>start</em>, <em>end</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.set_orientation" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the molecule by a rotation from <cite>start</cite> to <cite>end</cite>.</p>
<p>Given two direction vectors, <cite>start</cite> and <cite>end</cite>, this method
applies the rotation required transform <cite>start</cite> to <cite>end</cite> on
the molecule. The rotation occurs about the centroid of the
molecule.</p>
<p>For example, if the <cite>start</cite> and <cite>end</cite> vectors
are 45 degrees apart, a 45 degree rotation will be applied to
the molecule. The rotation will be along the appropriate
direction.</p>
<p>The great thing about this method is that you as long as you
can associate a geometric feature of the molecule with a
vector, then the molecule can be rotated so that this vector is
aligned with <cite>end</cite>. The defined vector can be virtually
anything. This means that any geometric feature of the molecule
can be easily aligned with any arbitrary axis.</p>
<p class="rubric">Notes</p>
<p>The difference between this method and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">StructUnit._set_orientation2()</span></code> is about which point the
rotation occurs: centroid of the entire molecule versus
centroid of the bonder atoms, respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A vector which is to be rotated so that it transforms to
the <cite>end</cite> vector.</li>
<li><strong>end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – This array holds the vector, onto which <cite>start</cite> is rotated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mol</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.set_position">
<code class="descname">set_position</code><span class="sig-paren">(</span><em>position</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.set_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the centroid of the molecule to <cite>position</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>position</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – This array holds the position on which the centroid of the
molecule should be placed.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecule with the centroid placed at
<cite>position</cite>. This is the same instance as that in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Molecule.mol</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.set_position_from_matrix">
<code class="descname">set_position_from_matrix</code><span class="sig-paren">(</span><em>pos_mat</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.set_position_from_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Set atomic positions of the molecule to those in <cite>pos_mat</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pos_mat</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – <p>The matrix holds the coordinates on which the atoms of the
molecule should be placed.</p>
<p>The shape of the matrix is <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">n]</span></code>. Each column of
<cite>pos_mat</cite> represents the coordinates of a single atom. The
1st column sets the coordinates of the atom with id of 0.
The next column sets the coordinates of the atom with id 1,
and so on.</p>
</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.shift">
<code class="descname">shift</code><span class="sig-paren">(</span><em>shift</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Shifts the coordinates of all atoms.</p>
<p>This does not modify the molecule. A modified copy is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>shift</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A numpy array holding the value of the shift along each
axis.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The id of the conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A copy of the molecule where the coordinates have been
shifted by <cite>shift</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.subclasses">
<code class="descname">subclasses</code><em class="property"> = {'Cage': &lt;class 'stk.molecular.molecules.cage.Cage'&gt;, 'CageComplex': &lt;class 'stk.molecular.molecules.cage.CageComplex'&gt;, 'CageStructUnit': &lt;class 'stk.molecular.molecules.cage.CageStructUnit'&gt;, 'MacroMolecule': &lt;class 'stk.molecular.molecules.macro_molecule.MacroMolecule'&gt;, 'Macrocycle': &lt;class 'stk.molecular.molecules.macrocycle.Macrocycle'&gt;, 'MacrocycleStructUnit': &lt;class 'stk.molecular.molecules.macrocycle.MacrocycleStructUnit'&gt;, 'Periodic': &lt;class 'stk.molecular.molecules.periodic.Periodic'&gt;, 'Polymer': &lt;class 'stk.molecular.molecules.polymer.Polymer'&gt;, 'Rotaxane': &lt;class 'stk.molecular.molecules.rotaxane.Rotaxane'&gt;, 'StructUnit': &lt;class 'stk.molecular.molecules.struct_unit.StructUnit'&gt;, 'StructUnit2': &lt;class 'stk.molecular.molecules.struct_unit.StructUnit2'&gt;, 'StructUnit3': &lt;class 'stk.molecular.molecules.struct_unit.StructUnit3'&gt;}</em><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.subclasses" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.update_cache">
<code class="descname">update_cache</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.update_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Update attributes of cached molecule.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code> returns modified copies of molecules.
In order to ensure that the cached molecules have
their attributes updated to the values of the copies, this
method must be run on the copies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.update_from_mae">
<code class="descname">update_from_mae</code><span class="sig-paren">(</span><em>path</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.update_from_mae" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates molecular structure to match an <code class="docutils literal notranslate"><span class="pre">.mae</span></code> file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path of the <code class="docutils literal notranslate"><span class="pre">.mae</span></code> file from which the structure
should be updated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to be updated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.update_from_mol">
<code class="descname">update_from_mol</code><span class="sig-paren">(</span><em>path</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.update_from_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates molecular structure to match an <code class="docutils literal notranslate"><span class="pre">.mol</span></code> file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path of the <code class="docutils literal notranslate"><span class="pre">.mol</span></code> file from which the structure
should be updated.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to be updated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.update_stereochemistry">
<code class="descname">update_stereochemistry</code><span class="sig-paren">(</span><em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.update_stereochemistry" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates stereochemistry tags in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Molecule.mol</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>None</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMolecule.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>path</em>, <em>atoms=None</em>, <em>conformer=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMolecule.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a molecular structure file of the molecule.</p>
<p>This bypasses the need for writing functions in <code class="docutils literal notranslate"><span class="pre">rdkit</span></code>.
These have issues with macromolecules due to poor ring finding
and sanitization issues.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The <cite>path</cite> to which the molecule should be written.</li>
<li><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</li>
<li><strong>conformer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The conformer to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="stk.molecular.molecules.macro_molecule.MacroMoleculeBuildError">
<em class="property">exception </em><code class="descclassname">stk.molecular.molecules.macro_molecule.</code><code class="descname">MacroMoleculeBuildError</code><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMoleculeBuildError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<dl class="attribute">
<dt id="stk.molecular.molecules.macro_molecule.MacroMoleculeBuildError.__init__">
<code class="descname">__init__</code><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMoleculeBuildError.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.macro_molecule.MacroMoleculeBuildError.args">
<code class="descname">args</code><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMoleculeBuildError.args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.macro_molecule.MacroMoleculeBuildError.with_traceback">
<code class="descname">with_traceback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.macro_molecule.MacroMoleculeBuildError.with_traceback" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Lukas Turcani

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>